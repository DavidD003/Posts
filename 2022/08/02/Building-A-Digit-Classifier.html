<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Title | David De Sa’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Where I share my projects and thoughts." />
<meta property="og:description" content="Where I share my projects and thoughts." />
<link rel="canonical" href="https://davidd003.github.io/Posts/2022/08/02/Building-A-Digit-Classifier.html" />
<meta property="og:url" content="https://davidd003.github.io/Posts/2022/08/02/Building-A-Digit-Classifier.html" />
<meta property="og:site_name" content="David De Sa’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-08-02T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Title" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-02T00:00:00-05:00","datePublished":"2022-08-02T00:00:00-05:00","description":"Where I share my projects and thoughts.","headline":"Title","mainEntityOfPage":{"@type":"WebPage","@id":"https://davidd003.github.io/Posts/2022/08/02/Building-A-Digit-Classifier.html"},"url":"https://davidd003.github.io/Posts/2022/08/02/Building-A-Digit-Classifier.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/Posts/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://davidd003.github.io/Posts/feed.xml" title="David De Sa's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/Posts/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/Posts/">David De Sa&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Posts/about/">About Me</a><a class="page-link" href="/Posts/search/">Search</a><a class="page-link" href="/Posts/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-08-02T00:00:00-05:00" itemprop="datePublished">
        Aug 2, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      25 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/DavidD003/Posts/tree/master/_notebooks/2022-08-02-Building A Digit Classifier.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/Posts/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/DavidD003/Posts/master?filepath=_notebooks%2F2022-08-02-Building+A+Digit+Classifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Posts/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/DavidD003/Posts/blob/master/_notebooks/2022-08-02-Building A Digit Classifier.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Posts/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FDavidD003%2FPosts%2Fblob%2Fmaster%2F_notebooks%2F2022-08-02-Building+A+Digit+Classifier.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/Posts/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-08-02-Building A Digit Classifier.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>
<span class="n">mnist</span><span class="o">=</span><span class="n">load_digits</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;data&#39;, &#39;target&#39;, &#39;frame&#39;, &#39;feature_names&#39;, &#39;target_names&#39;, &#39;images&#39;, &#39;DESCR&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="c1">#Observing y value for data sequence</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 2, ..., 8, 9, 8])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1">#Count of each digit in dataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[178, 182, 177, 183, 181, 182, 181, 179, 174, 180]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span> <span class="c1">#Size of dataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1797</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">16</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.    , 0.    , 0.625 , 0.875 , 0.5   , 0.0625, 0.    , 0.    ],
       [0.    , 0.125 , 1.    , 0.875 , 0.375 , 0.0625, 0.    , 0.    ],
       [0.    , 0.    , 0.9375, 0.9375, 0.5   , 0.9375, 0.    , 0.    ],
       [0.    , 0.    , 0.3125, 1.    , 1.    , 0.625 , 0.    , 0.    ],
       [0.    , 0.    , 0.75  , 0.9375, 0.9375, 0.75  , 0.    , 0.    ],
       [0.    , 0.25  , 1.    , 0.375 , 0.25  , 1.    , 0.375 , 0.    ],
       [0.    , 0.5   , 1.    , 0.625 , 0.5   , 1.    , 0.5   , 0.    ],
       [0.    , 0.0625, 0.5   , 0.75  , 0.875 , 0.75  , 0.0625, 0.    ]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="c1">#Visualizing example digit</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVR4nO3bIW4CQRhA4aWpQILHIcAgOQFn4AIcAc6AhCNg0RgMcAMcCsMRCBJHTZOmL/PvslOSNun75PzZzeZlks0sbePxeBT68vbbD/DXGAQMAgYBg8B7xTzrFTSbzcLZZrNJrk+n0/CayWQSzprN5vMP9l0jtegOAYOAQcAgYBAwCFS9dkO32y2cLZfLcNbtdpPrvV4v91Feyh0CBgGDgEHAIGAQyH7ttlqtcNZut8PZ9XpNrp/P5/Ca8Xhc+3653CFgEDAIGAQMAgaBRsVPmVkfmY/HYzgbDoe171f2AXqxWNS+3yc/Mj/DIGAQMAgYBLIPd2Xm83k4Kzv4RS6Xy08epxZ3CBgEDAIGAYOAQSD7cFf2DbTf74ez/X6fXO90Oi+9X1EUxWg0CmeFh7vnGAQMAgYBg4BBIPu0ezgcsq7bbrfJ9egvi6qUvf4rXrtJ7hAwCBgEDAIGAYNA9mn3fr+HF61Wq3C22+2S66fTKbxmMBiEs/V6Hc4q/pfG0+4zDAIGAYOAQcAgUPXa/XfcIWAQMAgYBAwCBoEP9mVPyh32olQAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1">#This loop because stacked=[[]]*10 makes 1 list in list, with 10 copies of pointers... need separate objects</span>
    <span class="n">stacked</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])):</span> <span class="c1">#Assign all images to the right collection in the &#39;stacked&#39; list, indexed by target</span>
    <span class="n">stacked</span><span class="p">[</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mnist</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lens</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stacked</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">lens</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">lens</span><span class="p">)</span> <span class="c1">#Confirm counts of samples</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([178, 182, 177, 183, 181, 182, 181, 179, 174, 180], 174)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked</span><span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="n">x</span><span class="p">[:</span><span class="mi">174</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stacked</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/conda/lib/python3.7/site-packages/fastai/torch_core.py:151: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1634272168290/work/torch/csrc/utils/tensor_new.cpp:201.)
  else torch.tensor(x, **kwargs) if isinstance(x, (tuple,list))
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="o">=</span><span class="p">[</span><span class="n">dig</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:]</span> <span class="k">for</span> <span class="n">dig</span> <span class="ow">in</span> <span class="n">stacked</span><span class="p">]</span>
<span class="n">train</span><span class="o">=</span><span class="p">[</span><span class="n">dig</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span> <span class="k">for</span> <span class="n">dig</span> <span class="ow">in</span> <span class="n">stacked</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],[</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="c1">#Confirm counts of samples #Confirm counts of samples</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([20, 20, 20, 20, 20, 20, 20, 20, 20, 20],
 [154, 154, 154, 154, 154, 154, 154, 154, 154, 154])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">stacked</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#Check sample</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkklEQVR4nO3aP2oCQRhA8RhSaCl4BAux8xhiKWxtZy2ewdIb2Fhbi8ew1MoriJ2dKUMe+82OE/IH8n7lfoxZHgPDLGk9Ho8XfXj97Rf4awwCBgGDgEHgrWFedARtt9twNpvNap8PBoNwzfF4DGftdjv7vaBV99AdAgYBg4BBwCBgEGg6dkPr9TqcbTabcLbf72ufTyaTcM3lcglnw+EwnJVwh4BBwCBgEDAIGARaDd9Uw+H1eg0XdTqdcDYajXLe65PT6fT0mgzednMYBAwCBgGDgEGg+Lbb7XbDWepIPp/Ptc+rqgrX3O/3cPaFj8y13CFgEDAIGAQMAsWXu1LRiTEej4t+73A4hLOGE8jLXQ6DgEHAIGAQMAj8+LEbSV3gFotFOOv3++FsuVym/qTHbg6DgEHAIGAQMAgUf1NNSf13UXSrvd1u4ZrdbhfO5vN5/otlcIeAQcAgYBAwCBgEvuXY7fV64Ww6nT79e6mjdbVaPf17Ke4QMAgYBAwCBgGDQNNH5n/HHQIGAYOAQcAgYBB4B/JKSyDaKoSnAAAAAElFTkSuQmCC
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">stacked</span><span class="p">),</span><span class="nb">type</span><span class="p">(</span><span class="n">stacked</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">type</span><span class="p">([</span><span class="n">stacked</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span> <span class="c1">#Check types</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Tensor, torch.Tensor, list)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">train</span><span class="p">),</span><span class="nb">type</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">type</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),[</span><span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">),</span><span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(list, torch.Tensor, torch.Tensor, [list, torch.Tensor, torch.Tensor])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">train</span><span class="p">)</span> <span class="c1">#Converts PyList of tensors to tensor of tesnors (join in new dimensions, retain target indexing)</span>
<span class="n">test</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([10, 154, 8, 8]), torch.Size([10, 20, 8, 8]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span><span class="n">stacked</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#Check dimensionality</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3, torch.Size([174, 8, 8]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">means</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">])</span> <span class="c1">#Compute the average digit</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">show_image</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwElEQVR4nO2bvWpCQRgF98aA2FjaWoj4g1haaSMWvo+PZOUTiL2VYCFiJ4idD6AgKpgy5LDHG5ZAApkpd1i4DAsfu2L2fD4DfPL22x/w1yCIQBCBIAJBhPccnzSCNpuNdePxOLper9ftnul0al21Wv3+h30liy1yQgSCCAQRCCIQRCCIkOVc7qy8Xq92U7PZtO58PkfXu92u3fN4PKxbLBbWlUol6wJj93sQRCCIQBCBIAJBhLzbrmW/31t3PB6tWy6X0fVGo2H3DIdD6w6Hg3Xtdts6BydEIIhAEIEgAkEEggjJY/d0OllXq9Ws63Q60fVyuWz3jEYj61arlXWM3R+AIAJBBIIIBBGSp8zlcrHu1c+L7p0zy6JPnCGEEAqFgnXujTYVTohAEIEgAkEEgggEEZLHbqvVsm6321l3u92i6/f73e7ZbrfW9ft961LghAgEEQgiEEQgiEAQIXnsvrrRvrq5TiaT6LobxyGEsF6vrev1etalwAkRCCIQRCCIQBCBIELy2C0Wi9bN53PrBoNBdP3VQ/JsNrOuUqlYlwInRCCIQBCBIAJBBIIIef+X+XdwQgSCCAQRCCIQRCCI8AEZXFAHsUC6YQAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuElEQVR4nO2cMaoqQRBFa55fRRExU0GMxNhc3IC6PXfiJswMTIw10FARNBB84edf+o7SL/gvOCesS0FzKCh6mJni9XoF/OXrfx/gt4EQASECQgSECH/e5Fkr6HQ62Wy1WiXrh8PB9iwWC5stl0ubNRoNm0VEkSoyIQJCBIQICBEQIiBEeLd2LWWXwsvlYrP1ep2sH49H2zMYDGw2n89tlgMTIiBEQIiAEAEhAkKE7LX7eDxsttlsbLbdbpP1Tqdje7rdrs2q1arNcmBCBIQICBEQIiBEQIiQvXZvt5vNdrudzZrNZrJeqVRsT6/Xs1lZXw5MiIAQASECQgSECNlbptVq2WwymdhsNpsl6+7SFxHRbrc/PdaPYUIEhAgIERAiIERAiJC9dsueZY5GI5uNx+NkvexCeL/fPz/YD2FCBIQICBEQIiBEQIiQvXbLnmWWZdfrNVl/Pp+2Z7/f22w6ndqs7JZcr9eTdSZEQIiAEAEhAkIEhAjZa7cokp+bRETEcDi0Wb/fT9bdGoyIOJ/PNit7SbhWq9mMtfshCBEQIiBEQIiAEKHgZwj/woQICBEQIiBEQIiAEOEbX2tEfj2qYsgAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxElEQVR4nO2cPYrCYBRFExG1VwQbwdJOJCuwdBEKdhauwN7OHdjYuwetlGBjZeEytBEVnHKYy3fjTGbAKc4p3+VBcvLgQf7i5/MZwSeFdx/AfwMhAkIEhAgIEYovcruCrterbZpMJjZbLBbB+nA4tD2z2cxmjUbDZnEc2yyKomDIhAgIERAiIERAiIAQ4dXatWy3W5stl0ubJUkSrK/Xa9tzOBxsVq/XbVYs/vz0mBABIQJCBIQICBEQIuReu5VKxWbT6dRm/X4/WB+Px7bndrt9/8B+CRMiIERAiIAQASECQoTca7fb7dqs3W7b7Hg8Buvn89n2NJtNmxUKf3tNmRABIQJCBIQICBFyb5lyuWyzx+Nhs9VqFax3Oh3bw5Z5IwgRECIgRECIgBAh99q93+82S9PUZrvdLlgfjUa2p1Qq2SzrTaas+74OJkRAiIAQASECQgSECLnXbtbjxfl8brP9fh+sZ32mstlsbNbr9Ww2GAxs5lY5EyIgRECIgBABIQJChNxrN+ul2FqtZjN3U/h0OtmerMecrVbLZpfLxWbVajVYZ0IEhAgIERAiIERAiBDzM4SvMCECQgSECAgRECIgRPgAoP1Q2MMDd0IAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2ElEQVR4nO2aPaoqQRgFZ54PQQN/AkHBpbgBU0UwFozMDAQ3ICK4AvdgYOAaDAQDN6CRmYGBiAre8MKhj+Od5D54VWEXH0rR0HZj/Hq9Ivjmz29/gX8NgggEEQgiEET4m+DtEXS/3+3QZDKxbjabBdfjOLYz8/ncul6vZ102m7UuiqLgB7JDBIIIBBEIIhBEIIgQJ1zurNztdnao0+lY1+12g+v7/d7OXC4X65bLpXXlctm6iGP3MwgiEEQgiEAQgSBC0m3XUqvVrFutVtaVSqXgervdtjONRsO6fD5vXRrYIQJBBIIIBBEIIhBESH3sVioV64rFonXT6TS4vtls7Mx4PLYu4SH5x7BDBIIIBBEIIhBESP2m+m7u8XhYt91ug+uj0cjOXK9X69brtXXVatW6iDfVzyCIQBCBIAJBBIIIqY/d5/Nph263m3W5XC64fjwe7Uyr1bJuMBhY1+/3rYs4dj+DIAJBBIIIBBEIIqR+U3137C4WC+vq9Xpw/XQ62Znz+WxdoVCw7t1PCvdHYXaIQBCBIAJBBIIIBBFSH7uZTMa6w+Fg3XA4DK67W3AUvb/RNptN69LADhEIIhBEIIhAEIEgQtIj838HO0QgiEAQgSACQQSCCF8N/WGs5cSuqgAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVR4nO2boYoCURhGnZ0FsVnFpGAyGQy+gpgFwWLyEXwAgw9hsZoExWaxabUbTBYNNjHoxoWP+e64U3Zhz4n/4epwuHCZcYxer1cOvvn47Qv4axBEIIhAEIEgwmeKz3QEPZ9P62azWeJ8Op3aNev12rpisWhdFEUhlyjZIQJBBIIIBBEIIhBESDt2M3E6nawbjUaJ8+FwmOm77ve7dfl83ro4jhPn7BCBIAJBBIIIBBEIIkQpz1StfDwedtFgMLDufD4nzsfjsV1zu92sq1ar1tVqNeviOOZu9x0IIhBEIIhAEIEgQuZjd7/f20WtVsu6xWKROD8ej3bN4XCwrtvtWtdut63L5XIcu+9AEIEgAkEEggiZn6kul0vrQifXZrNJnK9WK7vmcrlY1+/3rcsCO0QgiEAQgSACQQSCCMFjN3R8NhoN6zqdjnW73S5xHvr5s9frWddsNq3LAjtEIIhAEIEgAkEEggjBZ6qvgAy9uXO9Xq2bz+eJ88lkYtdst1vr6vW6dSnwTPUdCCIQRCCIQBCBIELwbjf0f5NCoWBdqVT68YVUKhXryuXyjz8vK+wQgSACQQSCCAQRCCKkvUH072CHCAQRCCIQRCCIQBDhC4VfZTAG7ZTgAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByUlEQVR4nO2ZoYoCURhGx3UNihoNBpNVMJgEQew+gPoG4iPYfQEfwK4vYDOZrAafwGAQQRAtblz4mG9m9pZd2HPiPfzDcLhwuTO59/sdwTcfv/0Cfw2CCAQRCCIQRPhM8fYIejwedmg2m1m33+9j12+3m51pNBrWLZdL6zqdjnVRFOXiFtkhAkEEgggEEQgiEETIpVzurDwej3ao1WpZ1+/3Y9cHg4GdaTab1iXN1Wo16yKO3WwQRCCIQBCBIAJBhLTbruVyuVhXLpetm8/nsevtdjvoeYVCwboQ2CECQQSCCAQRCCIQRAg+dpOOu3w+b91isYhd73a7dmY8HluXdBNOeg8HO0QgiEAQgSACQYTgb6pJvx43m4111+v1x8+r1+vWTSYT66rVqnUR31SzQRCBIAJBBIIIBBGCL3eVSsW60Whk3fl8jl3fbrd25n6/W/d8Pq0LgR0iEEQgiEAQgSACQYTgY/f1elm32+2sO51OseuHw8HO9Ho964rFonUhsEMEgggEEQgiEEQgiBB87CaxWq2sW6/XsevT6dTODIdD60qlUub3ygI7RCCIQBCBIAJBBIIIaf92/x3sEIEgAkEEgggEEQgifAHE1lNr+ZnD4AAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVR4nO2ZMYoCQRBFnUFDNTFQDMwEMxHvYS5iIngLIwMzLyEo3sF7GIg3EFEQBEHccHc//cehN9iFfS+sT0HzKChqJnm9XgX4JP3tB/w1ECIgRECIgBCh+CaPWkH3+91mw+EwWG+1WrZnPp/brFwu53/Yd5JQkQkRECIgRECIgBABIcK7tRvFarWy2W63C9a3263tKZVKP35TXpgQASECQgSECAgRECIkb76p2vDxeNimfr9vs8FgEKzPZjPbk7V2kyR4tOaBazcPCBEQIiBEQIiAECH62r1erzY7nU42q9frwfrxeLQ9jUbDZtVq1WYxK5kJERAiIERAiIAQIfq4OxwOtqnT6dis2+0G61nbotls2myxWET1FTju8oEQASECQgSECAgRotfu5XKxTbVazWbj8ThYn0wmtmez2disWPT36XK5tFmapqzdPCBEQIiAEAEhAkKE6G+qlUrFZqPRyGb7/T78kIz1eT6f8z/sC8/n02ZpGp4FJkRAiIAQASECQgSECNHXbha3281m0+k0WM+6aNvtts3W67XNer2ezRLzn5MJERAiIERAiIAQASHCu7X772BCBIQICBEQIiBEQIjwAVrlVCeI/L2mAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABw0lEQVR4nO3cP2pqQQCF8XvFP3AbNyBYCBZaWAqCnbgOK5dga+MKbOzchAuwFEEQdyBYiK3YWKgpQw5zrmRISIrvV87hwnsfA0Ne4KWv1yvBp8Jf/wH+G4IIggiCCIKI4ps96gnabrd2G41GwfPT6WS/6Xa7dptMJnbr9/t2y7IsDZ1zQwRBBEEEQQRBBEHEu2fXut/vdpvP53ar1WrB806nY785HA52ez6fdisWv//X44YIggiCCIIIggiCiOhnN02DPywmSZIk4/HYbu12O3i+Xq/tN7fbzW7NZtNupVLJbg43RBBEEEQQRBBEEEREP7t5qtWq3fb7ffB8sVjYb67Xq90ul4vdGo2G3RxuiCCIIIggiCCIiH5lHo+H3Varld2Wy2Xw/Hg82m8Gg4HdyuWy3WJwQwRBBEEEQQRBBEFE9LNbKPiWw+HQbpvNJnie96vM2Wxmt7x/U43BDREEEQQRBBEEEQQR0c9upVKxW71et9v5fA6eT6dT+02r1bJb3vMfgxsiCCIIIggiCCIIIn7lV5m73c5uWZYFz3u9nv3mp5/WPNwQQRBBEEEQQRBBEJHynyF8xQ0RBBEEEQQRBBEEER9OQkWzgG0CTwAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwklEQVR4nO2ZO4oCQRRFq/2goKihCCZuwEQwdxUm4iYMDMxcl5mpCzAVUxUMFEyccOBSt3qsZAbmnLAur7s9PnhUVfF+vwN8U/ntD/hrIERAiIAQASFCrSS3Iyg1nfb7vc1Wq1V0/Xw+25rtdmuzxWJhs3q9brMQQhFbpEMEhAgIERAiIERAiFCUbO5seL1ebdFkMrHZYDCIro9GI1tzOBxsttvtbNbv920WGLs/AyECQgSECAgRECKU7XYtt9vNZt1u12bL5TK6frlcbM3xeLRZtVq1WQ50iIAQASECQgSECAgRssduaic5m81stl6vP35X6pC51+t9/LwUdIiAEAEhAkIEhAjZU6bZbNpsPB7bzJ3FpqbWdDq1Wa2W/ROi0CECQgSECAgRECIgRMi+ynw+n7bInZuGEMJwOIyuv14vW9NqtWy22Wxs1m63bRa4yvwZCBEQIiBEQIiAECF7q1gU0akVQgjh8XjYzI3CSsX/N6fTyWb3+/3jd6WgQwSECAgRECIgRECIkD12G42GzVLXlfP5PLqeGtWpq8xOp2OzHOgQASECQgSECAgRECKUHTL/O+gQASECQgSECAgRECJ8AYiDT1ckGPJvAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByklEQVR4nO2bPWoCURRGZ0LUQgQLtRNsBQt73YALsHIJNvZ2Nu5DLO1cggtREBELBRELRTFl4GO+GfOaBHJO+Q4XhsODy/gTv16vCL75+O0H+GsQRCCIQBCBIMJnhrcrKG07LZdL6yaTSeJ5tVq1M6PRyLput2tdsVi0LoqiOOmQGyIQRCCIQBCBIAJBhDjj5c7Kw+FghzqdjnW9Xi/x/Hq92pntdmvdfD63rlarWRfHMWv3HQgiEEQgiEAQgSBC1tuu5Xw+W1coFKzr9/uJ56vVys7MZjPr0ta12aypcEMEgggEEQgiEEQgiBC8diuVinWtVss694HxbrezM8/n07rb7WZdCNwQgSACQQSCCAQRgrdMuVy2bjqdWrderxPP8/m8nRmPx9adTifrQuCGCAQRCCIQRCCIQBAheO2mUa/Xf+wul4udaTab1u33+/cf7A24IQJBBIIIBBEIIhBECF67j8fDusViYV2j0Ug8v9/vduZ4PFpXKpWsS/t1lPuakxsiEEQgiEAQgSACQYTgtZvL5axL+5/KcDhMPN9sNnZmMBhY1263rQuBGyIQRCCIQBCBIAJBhKz/y/w7uCECQQSCCAQRCCIQRPgC8I1ZcOf0ikUAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">l1_loss</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">means</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">F</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">means</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(1.4324), tensor(2.2704))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mnist_distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="n">mnist_distance</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">means</span><span class="p">)</span> <span class="c1">#  Intentional error to demonstrate</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_48/3541699495.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">def</span> mnist_distance<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">-</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>abs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>mnist_distance<span class="ansi-blue-fg">(</span>train<span class="ansi-blue-fg">,</span>means<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg">#  Intentional error to demonstrate</span>

<span class="ansi-green-fg">/tmp/ipykernel_48/3541699495.py</span> in <span class="ansi-cyan-fg">mnist_distance</span><span class="ansi-blue-fg">(a, b)</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">def</span> mnist_distance<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">-</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>abs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> mnist_distance<span class="ansi-blue-fg">(</span>train<span class="ansi-blue-fg">,</span>means<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg">#  Intentional error to demonstrate</span>

<span class="ansi-red-fg">RuntimeError</span>: The size of tensor a (154) must match the size of tensor b (10) at non-singleton dimension 1</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">means</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">means</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> 
<span class="c1">#Failure to broadcast generates above error because broadcasting requires equal dimension </span>
<span class="c1">#with different size. Unsqueeze to add dimension</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([10, 8, 8]),
 torch.Size([10, 154, 8, 8]),
 torch.Size([10, 1, 8, 8]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="o">=</span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">means</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#The result is 10 vectors each with 154 elements. Per the shapes spit out by previous cell</span>
<span class="c1">#you can see that the Means is being broadcast across the singleton dimension. What this means</span>
<span class="c1">#is that vector n in the 1st dimension of the result contains the result of the mean value for digit n compared </span>
<span class="c1">#against all 154 samples of train data for digit n. </span>
<span class="c1">#This allows us to see the best and worst samples of each digit</span>

<span class="c1">#View &#39;best&#39; and &#39;worst&#39; digits</span>
<span class="n">bestWorstIndex</span><span class="o">=</span><span class="p">[(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">b</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="n">bestWorstIndex</span><span class="p">:</span>
    <span class="n">show_image</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">b</span><span class="p">])</span>
    <span class="n">show_image</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">w</span><span class="p">])</span>
    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[1.0852, 1.7360, 1.5692,  ..., 1.4915, 1.1106, 1.2622],
        [1.7138, 2.3743, 2.4055,  ..., 2.9948, 3.0561, 3.4396],
        [3.0636, 2.3867, 1.5756,  ..., 1.7931, 2.0594, 1.7491],
        ...,
        [2.2926, 2.0388, 2.7857,  ..., 2.2317, 2.0384, 2.2423],
        [2.1914, 2.4976, 2.1855,  ..., 2.0434, 2.7443, 3.2455],
        [2.4969, 2.7304, 2.5003,  ..., 1.8816, 2.7387, 2.2446]]) torch.Size([10, 154])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnklEQVR4nO3aPYrCUBRA4WSYwk78WYOIYGGrINhq5wKs3YSbcQ/2YuMOtBXsdQlOIwwcck3yGJmBOV/pJU85BC4a88fjkenbx29/gL/GIGAQMAgYBD5L5kkr6HQ6hbPpdFr7vMPhEM4Gg0Ht857yohe9Q8AgYBAwCBgEDAJ5yZe7pLWb54UbLcuyLFuv17XP2+/34ex8Ptc+78m1W4VBwCBgEDAIGASS1+7xeAwvGo/H8YHB+93v9/Cadrsdzna7XTibz+fhLHPtVmMQMAgYBAwCBoGyH5lDzWYznPX7/drntVqtcNbpdMLZq2+7JWu3kHcIGAQMAgYBg0DylrlcLuFsuVymHltoOByGs263+6Pv5R0CBgGDgEHAIGAQSF67r1bharUKZ5vNpvD1RqOR9Dl6vV7SdRHvEDAIGAQMAgYBg8Bb/kE0m83CWfSYczKZhNcsFotwdrvdwtmr32kzH2VWYxAwCBgEDAIGgbes3ev1Gs5Go1Ht87bbbThLeVz55NqtwiBgEDAIGAQMAmVr99/xDgGDgEHAIGAQMAh8AZrrR+ioj/k3AAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkklEQVR4nO3aMWoCQRSA4RhSCDaC4AG8gzZ6AU+weA1rS2ux8gx6BG9g4RnstLAQb2DKkJ99s/IiJJD/K/cxWfkZGMbYejweb/ry/tsf4K8xCBgEDAIGgY+GeXgE3e/3cFG32w1nm82m9vntdgvXLBaLcPYDrbqH7hAwCBgEDAIGAYNAq+FyFw7H43G4aL1eh7PZbFb7fD6fh2t6vV44q6oqnDXw2H2GQcAgYBAwCBgEmm67oX6/n1p3PB5rn5duyMvlMvWuDHcIGAQMAgYBg4BBIH3b3e124aLBYBDOhsPhM5/rm/P5HM4ul0v2Xd52n2EQMAgYBAwC6cvdZDIJZ6vVKpxlTplOpxPOttvtS9/lDgGDgEHAIGAQMAikj93SvxcPh0P2z9Zqt9vh7HQ6vfRd7hAwCBgEDAIGAYNA+tgtHYWlXxBFvzwqrdnv9+Hser2Gswx3CBgEDAIGAYOAQSB97JaUvtydTqe1z0ejUepdpS+ZM9whYBAwCBgEDAIGgaZfEP077hAwCBgEDAIGAYPAJ44QRAWP3dteAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVR4nO3bvW2DQBxAcYgyANQukYegdkHJQszACgxAb8mFayQkD8ASXoGUUV584I9DjpT3K/mLC3o66SQT0nmeE337ePcD/DUGAYOAQcAg8Lkyf+oIOp/PwdnxeLx5vSiK4D11XQdnu93u/gf7Kb110R0CBgGDgEHAIGAQWDt2o2vb9uF7rtdrcNY0zSuP84s7BAwCBgGDgEHAILDJsTsMQ9T1yrKMut4SdwgYBAwCBgGDgEFgk2N3v99HXS/0w3SSJMnhcIj6t9whYBAwCBgEDAKbnDKn0ynqekuvOWNzh4BBwCBgEDAIGAQ2OXarqgrOuq57eL2lV5mxuUPAIGAQMAgYBAwCmxy74zhGXc9XmW9kEDAIGAQMAgaBdOWrzKe+l5mmKTjr+/7m9cvlErwnz/PgbOkfgbMsC84Sv5e5j0HAIGAQMAgYBNaO3X/HHQIGAYOAQcAgYBD4ArRjMeZ/nnZIAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWElEQVR4nO3csW2DUBRA0RBlAihZwDNQW3Lp0juwBkO4dMsStCzg0pIlBqBx5Y6UUa54IflBCcU9JU84X1dfeoWtZNM0vejD638fYGsMAgYBg4BB4G1h/mcrqOu6cLbf78NZ27bh7HQ6ffUns7mH3hAwCBgEDAIGAYPA0toNPZ/PcHa9XsPZ+XyefX65XJLOMY5j0nsRbwgYBAwCBgGDgEEgee3WdR3OUlZoVVXhrO/7H39eKm8IGAQMAgYBg4BBIHntNk0Tzg6HQzg7Ho+zz4dhCN/Z7XbfP9gveUPAIGAQMAgYBJK3TFmW4WzhK8RZj8cj9Sir8oaAQcAgYBAwCBgEktfuVhRFserneUPAIGAQMAgYBAwCm1m79/s96b3b7bbqObwhYBAwCBgEDAIGgc2s3dQf4OZ5vuo5vCFgEDAIGAQMAgaBzH+G8Jk3BAwCBgGDgEHAIPAOih0yaebE51sAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABg0lEQVR4nO3asW3CQBhA4SPKAFDTuWIb5ArvwAp0rOAa0dLBAHRUzIFbaOihiRTpyb8Nl5BEyvvK+2VsPZ10Ajy43W5Jn95++wH+GoOAQcAgYBB475lnHUGbzSacVVX19OedTqdwNh6Pn/68D4O2RXcIGAQMAgYBg4BBoO/YDeUercvlsnV9vV6H1xwOh3A2m83CWQ53CBgEDAIGAYOAQSD72D0ej+EsOlpTSmmxWLSudx27RVE8/Fxf5Q4Bg4BBwCBgEDAIDHr+ygyHTdNk3fB6vbauTyaT8JrL5RLOhsNh1nMkf2R+jEHAIGAQMAhknzK5yrJsXR+NRuE1q9Xqux8jJU+ZxxgEDAIGAYOAQSD7N9Uu+/0+nG2329b1rreEfpI7BAwCBgGDgEHAIPCSY7eu63AWfavd7XZZ95pOp+Es56VedwgYBAwCBgGDgEHgJcdu1xs/0bfd+Xyeda/z+RzOoreVurhDwCBgEDAIGAQMAn3/7f477hAwCBgEDAIGAYPAHcOkRwtOSGdMAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVR4nO3asW3CUBRAUTtKQU1NR8EENF4CVsAlYgToKBErMAJQMgBiAVqX7EAHTaREN342OEAi5Z7STx+sK0tf/pBeLpdEn95++wb+GoOAQcAgYBB4r5m/bAvK8zycbTabcHY4HMJZr9er+sq07KJPCBgEDAIGAYOAQSCtebl7+LZ7Op1Kr3c6nUafNxwOw9l6va5a6rZ7C4OAQcAgYBAwCNS97T7cdrstvd7tdsM1RVE863a+8QkBg4BBwCBgEDAIvHzb7ff7pdcHg0G4ZrlchrPJZPLje/rKJwQMAgYBg4BBoPGZ6vl8DhdFL3BJkiS73a70+mq1CtdkWRbO9vt9OKvhmeotDAIGAYOAQcAg0Hjbnc/n4aLZbHb3jVSdqR6Px3DWarXu/q4Pbru3MAgYBAwCBgGDQOMz1dFoFM7a7XY4i85Hq36uXCwW4Ww6nYazJnxCwCBgEDAIGAQMAi//4250OD0ej8M1VQfQ/nH3yQwCBgGDgEHAIFC37f47PiFgEDAIGAQMAgaBK+SIULg8+kWWAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVR4nO3aIW4CQRhA4aXpAQgSjUAgAYlBYHF4jsAtEOAABwfgJlgUgiuAxVHTpunL/rvDNrRN+j45fwYmL5tshlC73++ZPr389gH+GoOAQcAgYBB4LZlXegWt1+twtlwuc9cvl0u4Z7/fh7PhcJh+sK9qeYs+IWAQMAgYBAwCBoFayeUuHJ5Op3BTu90OZ+PxOHf9eDyGewaDQTjbbrfhrISv3RQGAYOAQcAgYBAou+1Wslqtwtl0Os1d73Q64Z7RaPTtM6XyCQGDgEHAIGAQMAhUvu1W1Wq1ctfP53O453A4hLNer1f1KN52UxgEDAIGAYPAUy53RaLfR4veMv1+P5xdr9dwVq/Xk8/1wScEDAIGAYOAQcAg8OOXu8jtdgtnzWYznG02m3A2mUyKvtLLXQqDgEHAIGAQMAg85bZb9O+i+Xyeu97tdsM9jUbj22dK5RMCBgGDgEHAIGAQeMptN/qXUJZl2W63e/jzZrNZOFssFg9/3jtvuykMAgYBg4BBwCBQ9tr9d3xCwCBgEDAIGAQMAm9MM0uf1JeRPAAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABf0lEQVR4nO3aP2oCQRhA8RjS2Im1nQex8Qr2suew24N4BG0FLcVLiJXaammnZeAx3+yfZJNA3q+cjwnDY2FwSO/5fL7p0/tvH+CvMQgYBAwCBoGPinl4Bd3v93BTWZbhbLlcJtdvt1vFUdLG43E4Ox6Pua291KJfCBgEDAIGAYOAQaDq2g1tNptwlrtCD4dDcv18Pod7ZrNZOJvP5+GsDb8QMAgYBAwCBgGDQK/iTfXbH1x3u11yPXe1TiaTcLZardoexV+7dRgEDAIGAYOAQaCTa/dyuYSz0WiUXM89TC8WizbHqOK1W4dBwCBgEDAItH5Tzbler433DIfDDk7SnF8IGAQMAgYBg4BB4MffVIuiSK6v1+twz+l0CmeDwaDtUfxxV4dBwCBgEDAIGAQ6uXYfj0c42+/3yfXpdBruyf1HktduxwwCBgGDgEHAIND6kTl3tfb7/cZ/b7vdhrMvXK2N+YWAQcAgYBAwCBgEqn7t/jt+IWAQMAgYBAwCBoEXvlNS4LNorIQAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVR4nO3aIW4CURRAUWgqkMwq2AA7AM8a0GxhRpHgsFgsFg8WARvAINFYHMgmN/MyzKNNm/Qe+V9+ZnLzk58p7T4ej46+fPz2C/w1BgGDgEHAIPDZMP/2K2i/39euj8fjcM9utwtno9Eo+yrdukVPCBgEDAIGAYOAQaDp2k25Xq/hLLpe5/N5uOeNq7U1TwgYBAwCBgGDgEGg2/A31XB4v9/DTZlrMvoKbnpWr9dLzTp+7b7GIGAQMAgYBAwC6a/d7XYbzg6HQzg7Ho+tnzUcDsPZZDIJZ8vlsvWzPCFgEDAIGAQMAulbZrPZpPadTqfa9cViEe65XC7hrKqq1HtEPCFgEDAIGAQMAgaB9LW7Xq9T+8qyrF2/3W7hnul0Gs76/X7qPSKeEDAIGAQMAgYBg0D6p8ys1WpVuz6bzcI95/M5nA0Gg+yr+FPmKwwCBgGDgEHAIPAj/7ibURRFOHvjam3NEwIGAYOAQcAgYBBo+tr9dzwhYBAwCBgEDAIGgSe2pEZXGGhZuQAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR4nO3ZMYoqQRRA0XKYoFNTQ/dgbGDmTjTUTM0EMxdiaOgaTAURxAWYaGjmhAOXerYW4/wPc09Yj26bS0HRbeN+vyd9+/jXD/C/MQgYBAwCBoHPmvmPH0Hj8Ti73u/3w2t6vd7L90sppfV6Hc6Ox2Mjt+4OAYOAQcAgYBAwCDRqXu6Kjt3VahXOBoNBdv10OoXXbDabcDadTsPZbrcLZ1VVeew+wyBgEDAIGAQMAnVvu0WiozWllEajUXa9qqqi+3W73XB2u93CWfR77hAwCBgEDAIGAYNA8bF7OBzC2eVyeXk2HA6L7vfIo6M84g4Bg4BBwCBgECj+pnq9XsOLms1m+RNlzOfzcDabzUpv6zfVZxgEDAIGAYOAQeAtf2Vut9twtlgssuvtdju8ZrlcljxGHY/dZxgEDAIGAYOAQeAtf2V2Op1wdj6fs+uTyeQdj/IydwgYBAwCBgGDgEHgLcfuI/v9PrvearV++Uny3CFgEDAIGAQMAgaBuo/Mf447BAwCBgGDgEHAIPAFAWhQBripzlIAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgElEQVR4nO3ZIW4CQRhAYWgqsGjWc4A9Axo8CixXWG6wGgmK0yAxXIA74Kgkfd1/ZhlI2qTvkzsZMnmZ5E+nw/v9PtDDx28f4K8xCBgEDAIGgc/MejiCbrdbuKlt23Btu91mD0Xj8ThcO5/P4dpkMkn97LDrozcEDAIGAYOAQcAgkBu7of1+H66lRutisej8PpvNSo/yVt4QMAgYBAwCBgGDQPHYnU6nRfvquu78Pp/Pwz2Zv1rfyhsCBgGDgEHAIGAQGGb+lRku7na7cNNms3nhSD9dLpdwrXT8D3xk7scgYBAwCBgEiqfM9XoNN6WmQlVVnd/X63W4JzVJUm+7GU6ZPgwCBgGDgEHAIFD8ppp65yx5A10ul+Ha8Xh8+vdKeUPAIGAQMAgYBAwCxWM35XQ6Pb3WNE24Z7VavXymvrwhYBAwCBgEDAIGgeJH5pTUg/HhcOj8nhqtqX+bjkaj/gf7zkfmPgwCBgGDgEHAIJAbu/+ONwQMAgYBg4BBwCDwBRP8Q9Yq1CHUAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjklEQVR4nO3aMWoCQRhA4dmQwlIP4TU8g52tWFt5Bs9gKTaCnV7B1tbGys7eRrAzZeBl/tnNRkkg7yvnZ2B5DAy7Wj0ej6RPb7/9AH+NQcAgYBAwCLzXzFtdQZPJJJz1er3s+vl8Dvccj8dwNhgMwtlyuQxnKaUqt+gJAYOAQcAgYBAwCFQ1L3etrt2qyt5oL7HZbMLZaDQqbfXabcIgYBAwCBgEDAJ1b7uh+/3+zOcoGg6H4azmav02TwgYBAwCBgGDgEGg9bVbcjgcwlm/38+uz2azcM9ut/vpIzXmCQGDgEHAIGAQeMk31dKLX6fTya5fr9dwT/TzZ0op/eAPP35TbcIgYBAwCBgEDAKtX+4ul0s4m06n4Wy73WbXb7dbuKd07T6bJwQMAgYBg4BBwCDQ+to9nU7hbL/fh7PFYpFdX6/X4Z7ST5nP5gkBg4BBwCBgEDAIvOQj83w+D2er1Sq7Ph6Pwz2lt+dut9vwqb7wI3MTBgGDgEHAIGAQqLt2/x1PCBgEDAIGAYOAQeADOJNMDciZ734AAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABj0lEQVR4nO3bMWoyQRiA4dmf1CJYegDvYGvhEcTSXjyAh7AQ72CpVuJlrLSwsrUzTSDwMp/rTlgS+N+nnI/V5WVgcDepns9n0rd/v30Df41BwCBgEDAIfNTMi46gx+MRzkajUXZ9sViE10wmk5LbqFPlFt0hYBAwCBgEDAIGgbpjt8jhcAhnt9stuz4ej9u4lcbcIWAQMAgYBAwCBoFWjt31eh3Ottttdr3b7bZxK425Q8AgYBAwCBgEDAJVzavMoofMVZV9fptSSulyuWTX+/1+yVf9hA+Z32EQMAgYBAwCxT/urtdr0XWr1Sq7fj6fiz5vs9mEs5KTyx0CBgGDgEHAIGAQaOWZ6iv3+z27vlwuw2tOp1M4m8/n4Wy3271/Y1/cIWAQMAgYBAwCBoHiY7fX64Wz4XDY+PM6nU44Ox6P4WwwGDT+rlfcIWAQMAgYBAwCBoFWXmW++n+Z6XSaXd/v9+E1s9ksnEUPrVOq/askX2W+wyBgEDAIGAQMAnXH7n/HHQIGAYOAQcAgYBD4BIvFQWX8qOLrAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABg0lEQVR4nO3YIY7CQBhA4WWzAgnFYap7AAQaPLiegZsBpifgAnABMDgscIMiN3np38IglmTfJ/tn0uZlksm0V9f1l359//UHfBqDgEHAIGAQ+OmYJx1Bm80mnK1Wq8bn1+s15VXv6DU9dIeAQcAgYBAwCBgEeh2Xu6RjN8uyl9d47H4og4BBwCBgEDAIdN12Q5fLJZzdbrdwtlwuG5+fTqdwTZ7n4azf74ezFO4QMAgYBAwCBgGDQPJtd7fbhYvm8/kbn/Sa/X4fziaTSdtSb7vPMAgYBAwCBoHky13bZazNer1ufL5YLMI14/E4nB0Oh3DWcco0coeAQcAgYBAwCBgEko/d0WiUtK4sy5fXtP2jnc1mSd8RcYeAQcAgYBAwCBgEkv+p3u/3cNFwOAxn0W237d/o+XwOZ1VVhbMO/lN9hkHAIGAQMAgYBJJvu4PBIJwdj8dwNp1OG58XRRGu2W63T3/Xu9whYBAwCBgEDAIGga7b7r/jDgGDgEHAIGAQMAg8AAkqS1nmQqpQAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkUlEQVR4nO3aPYrCUBRA4ThMYekC7LRwHy5ALUR3IGQPugI34F60tXMBgq2NTSztnHLgkJufN4QZmPOV75IYDoFHTHrv9zvTt4/fvoC/xiBgEDAIGAQ+a+ZJW9D9fg9nw+GwdH0+n6f8VLZer8PZarWqOrRXtugdAgYBg4BBwCBgEOjVPNwlbbuLxSKcPR6P1uc7n8/h7Hg8hrPpdFp1WrfdJgwCBgGDgEHAINDJtvt8PsPZYDAoXT+dTuExm80mnN1ut6aXRW67TRgEDAIGAYOAQaDuT+Yk/X4/nF2v19L13W4XHjObzcLZ6/VKuo6IdwgYBAwCBgGDQCe7zH6/D2fb7bb1+ar+Ux2NRuEsz/PWv+UdAgYBg4BBwCBgEOhk210ul+Hscrm0Pl/VV0JVD34pvEPAIGAQMAgYBAwCnbzKrDIej0vXD4dDeEzNl0CpfJXZhEHAIGAQMAgYBDrZdqPXlVmWZZPJpHS9KIrwmOirox9y223CIGAQMAgYBAwCddvuv+MdAgYBg4BBwCBgEPgCSrxM8s7dHukAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhUlEQVR4nO3ZIY7CUBRA0TIZwR7YAivAVhEUq8Dg2ARbQNW3HoeoqMKicRgMFlfkJDd9Le0MzCRzj+zLT5qbn7wURnVdJ/ry8dsv8NcYBAwCBgGDwGfH/MdX0GazaXx+Pp/DM2VZhrPb7RbOZrNZOKuqatT03BsCBgGDgEHAIGAQ6Fq7gxwOh3CWZVnj86IowjPb7TacLRaLcDafz8NZxBsCBgGDgEHAIGAQeMna3e/34Sxar2mahmcul8ug91iv173PeEPAIGAQMAgYBAwCo46/MsPh/X4PD02n03B2Op0an4/H4/DMcrkMZ22rtW2VJ0nij8zPMAgYBAwCBoHBH3dtW6Htr8fo3PF4DM9cr9dw1rFJevOGgEHAIGAQMAgYBAZ/3A0VfRS2rc88z8PZZDIZ+ip+3D3DIGAQMAgYBAwCL/krs01VVb3PfGO19uYNAYOAQcAgYBAwCLx97a5Wq8bnu93uzW/SzBsCBgGDgEHAIGAQ6PqR+d/xhoBBwCBgEDAIGAQeej5KyPEZ0tYAAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkUlEQVR4nO3br4oCURhAcV02WDWqSYPJp7DZBSdarT6TyeIrmH0Bi9XmjNGmZWHhMN/8E3Fhzy/Oxx3kcGG4o7Yfj0dLv74+/QH+GoOAQcAgYBD4Lpk3egTd7/dwtl6vc6/v9/twzW63C2ez2azy54J23kV3CBgEDAIGAYOAQaDssRu63W7hbDQahbPVapV7PcuycM1isQhnaZqGsybcIWAQMAgYBAwCBoHGj91OpxPOer1eOFsul7nX5/N5uGa73Vb/YC9yh4BBwCBgEDAIGATaJV9lNnrJfDwew1mSJLXvdzgcwtlgMKh9vx++ZK7CIGAQMAgYBBof7opMp9Paa87nczg7nU7h7IWnTC53CBgEDAIGAYOAQeAth7vNZhPOxuNx7vXJZBKuKfoq83K5hLOi974tD3fVGAQMAgYBg4BB4C2n3W63G86iX/wMh8NwTdGvi67XazhrchJ2h4BBwCBgEDAIGATectot+r9Mv9+vfT//L/NBBgGDgEHAIGAQKHvs/jvuEDAIGAQMAgYBg8ATJ9ZMvi3vHT0AAAAASUVORK5CYII=
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVR4nO3bMYrCQBhA4bhsY2ftBaxSptHSS3gF29xFz2DpFWwiKPba2NuoeIFYLjzyJxrX3YV9Xzk/I+ExMCixU5Zloi8fv/0Af41BwCBgEDAIfDbMW11Bo9EonJ1Op8r1NE3DPavVKpyt1+twNhgMwlmSJJ2qRU8IGAQMAgYBg4BBoOnabaUoinC22Wye/rzlchnObrfb059XxxMCBgGDgEHAIGAQeMu1OxwOw9nxeKxcn06n4Z79fh/OGr7RPs0TAgYBg4BBwCBgEHjLtVt3FU4mk8r1y+US7un1eq8+0sM8IWAQMAgYBAwCrW+Z6/Uazg6HQzjL87xyfbfbhXvG4/HDz/UqTwgYBAwCBgGDgEGg0/Ceajicz+fhpizLwln0plC/3w/3nM/ncPYC3yB6hEHAIGAQMAgYBFp/2627WrfbbTiLrt2631R/kicEDAIGAYOAQcAg0Prarft/y2KxCGfdbrdyfTabtX2Ub+UJAYOAQcAgYBAwCDT9yPzveELAIGAQMAgYBAwCd412RKkjC3LaAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVR4nO3aMWoCQRhAYQ0prEQ8wjYeQG28gNfZ0ttsJSoWegFPoAewEmwEK72BKQOP/WfdjZJA3lfOz8TlMWRY2Pbj8Wjp28dvP8BfYxAwCBgEDAKfFfNGV9B+vw9neZ6Xrl+v13DPYrEIZ+Px+OnngnbZoicEDAIGAYOAQcAg0K54uQuH9/s93JRlWThbr9el6/P5PNyz3W7D2eVyCWedTiectbx2n2MQMAgYBAwCBoGqt91Q6kq73W7hrNvtlq6PRqNwT1EU4ex8PoezwWAQziKeEDAIGAQMAgYBg8Bbrt3j8RjOZrNZ6fpwOAz3TCaTcLbb7cKZ1+4LGAQMAgYBg0DjWyYl9d99s9nU/nv9fv8nj1OLJwQMAgYBg4BBwCDwlmv31Q6HQzibTqcv/S1PCBgEDAIGAYOAQaDxF0Qpq9Wq9p7UV0epq/V0OoWzXq+X+km/IHqGQcAgYBAwCBgE3vK22+QKTX11tFwuw1nF1VqbJwQMAgYBg4BBwCBQ9bb773hCwCBgEDAIGAQMAl8CrkdBOXn2IAAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVR4nO3aMYrCQBhAYV22SCnaxc47aGFj4THsvIKHsfMCNh7AykIEW49gbYIg2Gm58MifZF11F/Z95fwMhsfAYLR5u90a+vLx2w/w1xgEDAIGAYPAZ8X8bVfQfr8PZ/P5PJxtNptwdjgcwlmSJM2idU8IGAQMAgYBg4BBoOrafbrZbFa4vtvtwj2TySScrVarcHa9XsNZkiSF654QMAgYBAwCBgGDwEuu3el0Gs56vV7h+mKxCPcsl8twNhqNwlmr1QpnEU8IGAQMAgYBg4BBoFnxU2Y4LHspPBgMfvBI37Ner8PZeDwu2+pL5joMAgYBg4BB4OFbpky73Q5nWZYVrg+Hw3DPdrsNZ8fjMZx1u91w1vCWqccgYBAwCBgEDAIvuXbzPA9nl8ulcL3T6YR70jQNZ6fTqfZzgdduHQYBg4BBwCBgEHjJtfuIsne0Zfr9/qMf6bVbh0HAIGAQMAgYBN7+x93I+XwOZxU/ST6VJwQMAgYBg4BBwCBQ9W333/GEgEHAIGAQMAgYBO6rok8+sbERjwAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#% accuracy for our baseline model. In that case we want each digit in test set compared </span>
<span class="c1">#against every mean digit, and then to observe, for each test digit, comparison against</span>
<span class="c1">#which mean yielded least difference? To do that we need to broadcast more</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape of means         :&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape of train data    :&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="c1">#First of all, we want to unsqueeze the training tensor so that we can broadcast it up, creating multiple copies of itself</span>
<span class="c1">#in that higher dimension. We want to have one copy of the training data for each of the mean (&#39;ideal&#39;) digits </span>
<span class="c1">#for comparison, thats why we do that. Creating singleton dimensions allows for broadcasting to essentially create copies of </span>
<span class="c1">#the data contained in the lower dimensions of the container.</span>
<span class="c1">#</span>
<span class="c1">#The means s unsqueezed multiple times because we want copies of copies of each of the mean digits. We unsqueeze at the first</span>
<span class="c1">#index so that the dimension where the differentiation between digits occurs stays at the highest dimension</span>
<span class="c1">#</span>
<span class="c1">#The result is that the 10,1,1,8,8 tensor and 1,10,154,8,8 tensors are broadcast to be equal in shape to perform</span>
<span class="c1">#computation. First in dimension 1, the train data is broadcast (10 copies created), in dimension 2 the mean data is broadcast</span>
<span class="c1">#creating 10 copies of everything below. Then in the 3rd dimension, the means is again broadcast up to 154, creating 154 more</span>
<span class="c1">#copies of what is in the dimensions below. In this way, the 1st dimension corresponds to the different &#39;ideal&#39; or mean </span>
<span class="c1">#digits 0-9, the 2nd dimension corresponds to all the data corresponding to the training data for digits 0-9. The 3rd</span>
<span class="c1">#dimension differentiates between individual samples of a given training digit. And the 4th and 5th dimension get us to</span>
<span class="c1">#individual pixels</span>
<span class="c1">#</span>
<span class="n">all_comparison</span><span class="o">=</span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">means</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">train</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape of all comparison:     &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">all_comparison</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1">#The result is 3 instead of 5 dimensions because the mnist function took the average across the last two dimensions</span>
<span class="c1">#reducing the data in them to a scalar stored in the 3rd dimension. So for axis i in the first dimension, we have </span>
<span class="c1">#10 collections of data, which is the ideal digit i compared against the 154 samples for each digit as indexed in </span>
<span class="c1">#the 2nd dimension</span>

<span class="c1">#Picturing the 3D result as a cube, each element in the cube contains the numeric result from mnist_dist for the comparison</span>
<span class="c1">#of ideal and test image. For a given test digit, it is compared against all 9 ideal digits, and the miniumum mnist_distance</span>
<span class="c1">#should correspond to the digit that the training digit actually is. Therefore we iterate through taking slices of the cube</span>
<span class="c1">#where in each iteration, a slice corresponds to all 154 training images for one and the same digit, each compared against</span>
<span class="c1">#all 9 ideal digits</span>
<span class="k">def</span> <span class="nf">acc_rslt</span><span class="p">(</span><span class="n">comp</span><span class="p">):</span>
    <span class="n">c</span><span class="o">=</span><span class="n">comp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">shape</span><span class="p">]</span>
    <span class="n">totSamp</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">z</span>
    <span class="n">totCorrect</span><span class="o">=</span><span class="mi">0</span> <span class="c1">#Tallier</span>
    <span class="n">confM</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#confusion matrix will be result of stacking the bincount results</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="c1">#Taking slice yields 2D object, shape (10,154), take min in each column (axis 1) to get digit prediction</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">c</span><span class="p">[:,</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span> <span class="c1"># Retrieve indices i.e. predictions for all comparisons</span>
        <span class="n">predCnt</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span><span class="n">minlength</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#Yields a 1D tensor with count of integers indexed by integer</span>
        <span class="n">totCorrect</span><span class="o">=</span><span class="n">totCorrect</span><span class="o">+</span><span class="n">predCnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">confM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predCnt</span><span class="p">)</span>
    <span class="n">confM</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">confM</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">totCorrect</span><span class="o">/</span><span class="n">totSamp</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">confM</span>
<span class="n">acc</span><span class="p">,</span><span class="n">conf</span><span class="o">=</span><span class="n">acc_rslt</span><span class="p">(</span><span class="n">all_comparison</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;accuracy: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span><span class="s1">&#39;6pt&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Top Axis: Predicted value. Left Axis: Actual Value&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>shape of means         :torch.Size([10, 1, 1, 8, 8])
shape of train data    :torch.Size([1, 10, 154, 8, 8])
shape of all comparison:     torch.Size([10, 10, 154])
accuracy: 89.94%
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
</style>
<table id="T_a0277_">
  <caption>Top Axis: Predicted value. Left Axis: Actual Value</caption>
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th class="col_heading level0 col0">0</th>
      <th class="col_heading level0 col1">1</th>
      <th class="col_heading level0 col2">2</th>
      <th class="col_heading level0 col3">3</th>
      <th class="col_heading level0 col4">4</th>
      <th class="col_heading level0 col5">5</th>
      <th class="col_heading level0 col6">6</th>
      <th class="col_heading level0 col7">7</th>
      <th class="col_heading level0 col8">8</th>
      <th class="col_heading level0 col9">9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_a0277_level0_row0" class="row_heading level0 row0">0</th>
      <td id="T_a0277_row0_col0" class="data row0 col0">153</td>
      <td id="T_a0277_row0_col1" class="data row0 col1">0</td>
      <td id="T_a0277_row0_col2" class="data row0 col2">0</td>
      <td id="T_a0277_row0_col3" class="data row0 col3">0</td>
      <td id="T_a0277_row0_col4" class="data row0 col4">1</td>
      <td id="T_a0277_row0_col5" class="data row0 col5">0</td>
      <td id="T_a0277_row0_col6" class="data row0 col6">0</td>
      <td id="T_a0277_row0_col7" class="data row0 col7">0</td>
      <td id="T_a0277_row0_col8" class="data row0 col8">0</td>
      <td id="T_a0277_row0_col9" class="data row0 col9">0</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row1" class="row_heading level0 row1">1</th>
      <td id="T_a0277_row1_col0" class="data row1 col0">0</td>
      <td id="T_a0277_row1_col1" class="data row1 col1">124</td>
      <td id="T_a0277_row1_col2" class="data row1 col2">8</td>
      <td id="T_a0277_row1_col3" class="data row1 col3">1</td>
      <td id="T_a0277_row1_col4" class="data row1 col4">0</td>
      <td id="T_a0277_row1_col5" class="data row1 col5">2</td>
      <td id="T_a0277_row1_col6" class="data row1 col6">4</td>
      <td id="T_a0277_row1_col7" class="data row1 col7">0</td>
      <td id="T_a0277_row1_col8" class="data row1 col8">4</td>
      <td id="T_a0277_row1_col9" class="data row1 col9">11</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row2" class="row_heading level0 row2">2</th>
      <td id="T_a0277_row2_col0" class="data row2 col0">0</td>
      <td id="T_a0277_row2_col1" class="data row2 col1">6</td>
      <td id="T_a0277_row2_col2" class="data row2 col2">136</td>
      <td id="T_a0277_row2_col3" class="data row2 col3">4</td>
      <td id="T_a0277_row2_col4" class="data row2 col4">0</td>
      <td id="T_a0277_row2_col5" class="data row2 col5">0</td>
      <td id="T_a0277_row2_col6" class="data row2 col6">0</td>
      <td id="T_a0277_row2_col7" class="data row2 col7">2</td>
      <td id="T_a0277_row2_col8" class="data row2 col8">5</td>
      <td id="T_a0277_row2_col9" class="data row2 col9">1</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row3" class="row_heading level0 row3">3</th>
      <td id="T_a0277_row3_col0" class="data row3 col0">1</td>
      <td id="T_a0277_row3_col1" class="data row3 col1">0</td>
      <td id="T_a0277_row3_col2" class="data row3 col2">1</td>
      <td id="T_a0277_row3_col3" class="data row3 col3">143</td>
      <td id="T_a0277_row3_col4" class="data row3 col4">0</td>
      <td id="T_a0277_row3_col5" class="data row3 col5">0</td>
      <td id="T_a0277_row3_col6" class="data row3 col6">0</td>
      <td id="T_a0277_row3_col7" class="data row3 col7">4</td>
      <td id="T_a0277_row3_col8" class="data row3 col8">2</td>
      <td id="T_a0277_row3_col9" class="data row3 col9">3</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row4" class="row_heading level0 row4">4</th>
      <td id="T_a0277_row4_col0" class="data row4 col0">1</td>
      <td id="T_a0277_row4_col1" class="data row4 col1">3</td>
      <td id="T_a0277_row4_col2" class="data row4 col2">0</td>
      <td id="T_a0277_row4_col3" class="data row4 col3">0</td>
      <td id="T_a0277_row4_col4" class="data row4 col4">143</td>
      <td id="T_a0277_row4_col5" class="data row4 col5">0</td>
      <td id="T_a0277_row4_col6" class="data row4 col6">0</td>
      <td id="T_a0277_row4_col7" class="data row4 col7">7</td>
      <td id="T_a0277_row4_col8" class="data row4 col8">0</td>
      <td id="T_a0277_row4_col9" class="data row4 col9">0</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row5" class="row_heading level0 row5">5</th>
      <td id="T_a0277_row5_col0" class="data row5 col0">1</td>
      <td id="T_a0277_row5_col1" class="data row5 col1">0</td>
      <td id="T_a0277_row5_col2" class="data row5 col2">0</td>
      <td id="T_a0277_row5_col3" class="data row5 col3">1</td>
      <td id="T_a0277_row5_col4" class="data row5 col4">1</td>
      <td id="T_a0277_row5_col5" class="data row5 col5">131</td>
      <td id="T_a0277_row5_col6" class="data row5 col6">3</td>
      <td id="T_a0277_row5_col7" class="data row5 col7">0</td>
      <td id="T_a0277_row5_col8" class="data row5 col8">0</td>
      <td id="T_a0277_row5_col9" class="data row5 col9">17</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row6" class="row_heading level0 row6">6</th>
      <td id="T_a0277_row6_col0" class="data row6 col0">1</td>
      <td id="T_a0277_row6_col1" class="data row6 col1">1</td>
      <td id="T_a0277_row6_col2" class="data row6 col2">0</td>
      <td id="T_a0277_row6_col3" class="data row6 col3">0</td>
      <td id="T_a0277_row6_col4" class="data row6 col4">1</td>
      <td id="T_a0277_row6_col5" class="data row6 col5">0</td>
      <td id="T_a0277_row6_col6" class="data row6 col6">151</td>
      <td id="T_a0277_row6_col7" class="data row6 col7">0</td>
      <td id="T_a0277_row6_col8" class="data row6 col8">0</td>
      <td id="T_a0277_row6_col9" class="data row6 col9">0</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row7" class="row_heading level0 row7">7</th>
      <td id="T_a0277_row7_col0" class="data row7 col0">0</td>
      <td id="T_a0277_row7_col1" class="data row7 col1">0</td>
      <td id="T_a0277_row7_col2" class="data row7 col2">0</td>
      <td id="T_a0277_row7_col3" class="data row7 col3">0</td>
      <td id="T_a0277_row7_col4" class="data row7 col4">1</td>
      <td id="T_a0277_row7_col5" class="data row7 col5">1</td>
      <td id="T_a0277_row7_col6" class="data row7 col6">0</td>
      <td id="T_a0277_row7_col7" class="data row7 col7">152</td>
      <td id="T_a0277_row7_col8" class="data row7 col8">0</td>
      <td id="T_a0277_row7_col9" class="data row7 col9">0</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row8" class="row_heading level0 row8">8</th>
      <td id="T_a0277_row8_col0" class="data row8 col0">0</td>
      <td id="T_a0277_row8_col1" class="data row8 col1">15</td>
      <td id="T_a0277_row8_col2" class="data row8 col2">2</td>
      <td id="T_a0277_row8_col3" class="data row8 col3">2</td>
      <td id="T_a0277_row8_col4" class="data row8 col4">0</td>
      <td id="T_a0277_row8_col5" class="data row8 col5">4</td>
      <td id="T_a0277_row8_col6" class="data row8 col6">2</td>
      <td id="T_a0277_row8_col7" class="data row8 col7">2</td>
      <td id="T_a0277_row8_col8" class="data row8 col8">119</td>
      <td id="T_a0277_row8_col9" class="data row8 col9">8</td>
    </tr>
    <tr>
      <th id="T_a0277_level0_row9" class="row_heading level0 row9">9</th>
      <td id="T_a0277_row9_col0" class="data row9 col0">0</td>
      <td id="T_a0277_row9_col1" class="data row9 col1">3</td>
      <td id="T_a0277_row9_col2" class="data row9 col2">0</td>
      <td id="T_a0277_row9_col3" class="data row9 col3">5</td>
      <td id="T_a0277_row9_col4" class="data row9 col4">4</td>
      <td id="T_a0277_row9_col5" class="data row9 col5">1</td>
      <td id="T_a0277_row9_col6" class="data row9 col6">0</td>
      <td id="T_a0277_row9_col7" class="data row9 col7">6</td>
      <td id="T_a0277_row9_col8" class="data row9 col8">2</td>
      <td id="T_a0277_row9_col9" class="data row9 col9">133</td>
    </tr>
  </tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
<span class="n">test_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
<span class="n">train_y</span><span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span><span class="p">[],[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">train_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="mi">154</span><span class="p">)</span>
    <span class="n">test_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
<span class="n">train_y</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">train_y</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_y</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="n">test_y</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">test_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">train_y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">test_y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([1540, 64]),
 torch.Size([200, 64]),
 torch.Size([1540, 1]),
 torch.Size([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dset</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">))</span> <span class="c1">#Zip each input data item to its target output</span>
<span class="n">valid_dset</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">))</span>
<span class="c1">#Define DataLoader objects to pass to learner</span>
<span class="n">dl</span><span class="o">=</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="n">valid_dl</span><span class="o">=</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dset</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>

<span class="n">dls</span><span class="o">=</span><span class="n">DataLoaders</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span><span class="n">valid_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementing-Net,-Learning-using-custom-defined-model,-learner..">Implementing Net, Learning using custom defined model, learner..<a class="anchor-link" href="#Implementing-Net,-Learning-using-custom-defined-model,-learner.."> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="n">std</span><span class="o">=.</span><span class="mi">1</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>torch.randn<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w1</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#Have to provide extra dimension for matrix mutiplication, making it a single-column vector</span>
<span class="n">b1</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">w2</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># Have to provide an extra dimension (1) for matrix multiplication</span>
<span class="n">b2</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#w1,b1,w2,b2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">myModel</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span>
    <span class="n">res</span><span class="o">=</span> <span class="n">xb</span><span class="nd">@w1</span><span class="o">+</span><span class="n">b1</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@w2</span><span class="o">+</span><span class="n">b2</span><span class="c1">#returns 10 features for each input</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">myModel</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span>
    <span class="n">res</span><span class="o">=</span> <span class="n">xb</span><span class="nd">@w1</span><span class="o">+</span><span class="n">b1</span>
    <span class="c1">#res=res.max(tensor(0.))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@w2</span><span class="o">+</span><span class="n">b2</span><span class="c1">#returns 10 features for each input</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mini_samp</span><span class="o">=</span><span class="mi">5</span>
<span class="n">mini_x</span><span class="o">=</span><span class="n">train_x</span><span class="p">[:</span><span class="n">mini_samp</span><span class="p">]</span>  <span class="c1">#Define a minibatch to test that the model works as intended w.r.t broadcasting across different tensor sizes...</span>
<span class="n">mini_y</span><span class="o">=</span><span class="n">train_y</span><span class="p">[:</span><span class="n">mini_samp</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span> <span class="c1">#test model.. output is a tensor of 10 elements per input image.. </span>
<span class="c1">#each to be interpreted as activation for a given digit as being predicted</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 3.3562, -3.1369, -3.0656, -2.9660,  3.1947,  2.4069,  3.5504, -3.1804, -2.6910, -2.5367],
        [ 4.2326, -4.0526, -3.9617, -3.8346,  4.0265,  3.0212,  4.4803, -4.1081, -3.4837, -3.2867],
        [ 3.1284, -2.8989, -2.8327, -2.7402,  2.9784,  2.2472,  3.3086, -2.9392, -2.4849, -2.3417],
        [ 5.2939, -5.1616, -5.0468, -4.8864,  5.0338,  3.7653,  5.6065, -5.2316, -4.4436, -4.1951],
        [ 4.4871, -4.3187, -4.2219, -4.0869,  4.2681,  3.1997,  4.7504, -4.3776, -3.7139, -3.5046]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="c1">#softmax returns a larger value for a given index, the larger that number was in proportion to the others</span>
    <span class="c1">#it motivates the network to reduce confidence in other choices at same time as increasing confidence in single output</span>
    <span class="c1">#Take the inverse since the goal is to reduce loss</span>
    <span class="c1">#Understanding that the largest activation is the prediction.</span>
    <span class="c1"># Recall the input is variable [minibatch] size.</span>
    <span class="n">maxes</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correctIndices</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">maxes</span><span class="p">,</span><span class="n">target</span><span class="p">)]</span>
    <span class="n">resy</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tens</span><span class="p">)</span> <span class="k">for</span> <span class="n">tens</span> <span class="ow">in</span> <span class="n">correctIndices</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resy</span><span class="p">)</span> <span class="c1">#The above lines were tested to ensure the operations (softmax, indexing, -log, sum) retain gradient</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maxes</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">maxes</span><span class="p">)</span>
<span class="c1">#Observe! The softmax loss function yields -inf sometimes which will not allow for computaiton of meaningful gradient..</span>
<span class="c1">#If it didn&#39;t this time, just try different input (re run parameter initialization)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ -9.9796,  -0.6258,  -1.2575,  -6.4255,  -4.6406,  -3.7542, -10.6129,  -8.0086,  -4.6604,  -1.9932],
        [ -6.6498,  -0.9041,  -1.2921,  -4.4667,  -3.3703,  -2.8258,  -7.0388,  -5.4391,  -3.3824,  -1.7440],
        [ -8.9221,  -0.6952,  -1.2507,  -5.7962,  -4.2263,  -3.4467,  -9.4791,  -7.1886,  -4.2437,  -1.8978],
        [ -1.0974,  -9.4461,  -8.8823,  -4.2696,  -5.8627,  -6.6539,  -0.5322,  -2.8566,  -5.8451,  -8.2257],
        [ -4.8328,  -1.1909,  -1.4368,  -3.4490,  -2.7541,  -2.4089,  -5.0793,  -4.0654,  -2.7617,  -1.7233]], grad_fn=&lt;LogBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#to numeric underflow, resulting in trying to take the log of 0, and having undefined (-inf) results</span>
<span class="c1">#that cannot be differentiated..</span>
<span class="n">maxes</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">correctIndices</span><span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="n">r</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">maxes</span><span class="p">,</span><span class="n">mini_y</span><span class="p">)])</span>
<span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">mini_y</span><span class="p">,</span><span class="n">maxes</span><span class="p">,</span><span class="n">correctIndices</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">correctIndices</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[-4.1185,  5.2352,  4.6036, -0.5644,  1.2204,  2.1069, -4.7518, -2.1475,  1.2007,  3.8679],
         [-2.4601,  3.2856,  2.8976, -0.2769,  0.8195,  1.3640, -2.8491, -1.2493,  0.8073,  2.4457],
         [-3.6006,  4.6264,  4.0708, -0.4746,  1.0952,  1.8748, -4.1576, -1.8670,  1.0779,  3.4238],
         [ 4.0184, -4.3303, -3.7665,  0.8462, -0.7469, -1.5381,  4.5836,  2.2592, -0.7293, -3.1099],
         [-1.4931,  2.1488,  1.9029, -0.1093,  0.5857,  0.9308, -1.7396, -0.7257,  0.5780,  1.6164]], grad_fn=&lt;AddBackward0&gt;),
 tensor([[0],
         [0],
         [0],
         [0],
         [0]]),
 tensor([[4.6336e-05, 5.3481e-01, 2.8437e-01, 1.6197e-03, 9.6515e-03, 2.3419e-02, 2.4597e-05, 3.3259e-04, 9.4631e-03, 1.3626e-01],
         [1.2943e-03, 4.0489e-01, 2.7469e-01, 1.1486e-02, 3.4380e-02, 5.9262e-02, 8.7718e-04, 4.3435e-03, 3.3966e-02, 1.7481e-01],
         [1.3341e-04, 4.9899e-01, 2.8630e-01, 3.0391e-03, 1.4606e-02, 3.1851e-02, 7.6432e-05, 7.5518e-04, 1.4355e-02, 1.4990e-01],
         [3.3373e-01, 7.8998e-05, 1.3882e-04, 1.3987e-02, 2.8436e-03, 1.2890e-03, 5.8731e-01, 5.7462e-02, 2.8941e-03, 2.6769e-04],
         [7.9645e-03, 3.0395e-01, 2.3768e-01, 3.1778e-02, 6.3669e-02, 8.9912e-02, 6.2240e-03, 1.7157e-02, 6.3182e-02, 1.7848e-01]], grad_fn=&lt;SoftmaxBackward0&gt;),
 tensor([4.6336e-05, 1.2943e-03, 1.3341e-04, 3.3373e-01, 7.9645e-03]),
 tensor([-9.9796, -6.6498, -8.9221, -1.0974, -4.8328]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lossResults</span><span class="o">=</span><span class="n">my_loss</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">mini_y</span><span class="p">)</span> <span class="c1">#Testing the loss function works(assuming mini_x of 3 samples)</span>
<span class="n">lossResults</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([31.4817], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#to avoid underflow. Trying out basic code from the doc&#39;s here:</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span><span class="o">.</span><span class="n">random_</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">input</span><span class="p">,</span><span class="n">target</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[ 1.9199, -0.2254, -0.3417,  0.3040, -0.6890],
         [-1.1267, -0.2858, -1.0935,  1.1351,  0.7592],
         [-3.5945,  0.0192,  0.1052,  0.9603, -0.5672]], requires_grad=True),
 tensor([4, 1, 2]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lossy</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">inp</span><span class="o">=</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span>
<span class="n">otpt</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">mini_y</span><span class="p">))</span>
<span class="n">lossy</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span><span class="n">otpt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(6.2963, grad_fn=&lt;NllLossBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#The ideal loss function returns less loss if either confidence of right digit increases, or confidence</span>
<span class="c1">#of wrong digit decreases. From this rational I get this:</span>
<span class="c1">#Loss=sum(abs([model outputs for wrong digits]))/([Model output for right digit])</span>
<span class="c1">#This way, loss goes down as input for right digit goes up, and loss goes up as input for wrong digits go up</span>
<span class="k">def</span> <span class="nf">my_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
    <span class="c1">#Picked up a trick to place 0s at specfic indices in  a tensor here:https://discuss.pytorch.org/t/creating-big-tensors-and-insert-ones-at-specific-dimensions/100025/2</span>
    <span class="c1">#But it only works for 3D tensors and I couldnt find out how to generalize it to 2... so the following lines do some unsqueezing</span>
    <span class="c1">#To singleton upscale existing tensors to make this work. essentially getting a 0s/1s tensor with 1 at target indicies</span>
    <span class="c1">#to facilitate the loss calculation by isolating target values</span>
    <span class="n">zeros</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tgts</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">zeros</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#Make target indices=1</span>
    <span class="n">targets_as_ones</span><span class="o">=</span><span class="n">zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#This retrieves the 2D tensor from the singleton 3D tensor</span>
    <span class="n">targets_as_zeros</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets_as_ones</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">targets</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span> <span class="c1">#Pull out the NN output for the neuron </span>
    <span class="c1">#that represents the target value for that item.</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">preds</span><span class="o">*</span><span class="n">targets_as_zeros</span><span class="o">/</span><span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_loss</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">mini_y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(31.4133, grad_fn=&lt;SumBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="o">=</span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span>
<span class="n">zeros</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tgts</span><span class="o">=</span><span class="n">mini_y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">zeros</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#Make target indices=1</span>
<span class="n">targets_as_ones</span><span class="o">=</span><span class="n">zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#This retrieves the 2D tensor from the singleton 3D tensor</span>
<span class="n">targets_as_zeros</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">targets_as_ones</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">targets</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
<span class="n">preds</span><span class="o">*</span><span class="n">targets_as_zeros</span><span class="p">,</span><span class="n">preds</span><span class="o">*</span><span class="n">targets_as_ones</span><span class="p">,</span><span class="n">preds</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[-0.0000,  5.2352,  4.6036, -0.5644,  1.2204,  2.1069, -4.7518, -2.1475,  1.2007,  3.8679],
         [-0.0000,  3.2856,  2.8976, -0.2769,  0.8195,  1.3640, -2.8491, -1.2493,  0.8073,  2.4457],
         [-0.0000,  4.6264,  4.0708, -0.4746,  1.0952,  1.8748, -4.1576, -1.8670,  1.0779,  3.4238],
         [ 0.0000, -4.3303, -3.7665,  0.8462, -0.7469, -1.5381,  4.5836,  2.2592, -0.7293, -3.1099],
         [-0.0000,  2.1488,  1.9029, -0.1093,  0.5857,  0.9308, -1.7396, -0.7257,  0.5780,  1.6164]], grad_fn=&lt;MulBackward0&gt;),
 tensor([[-4.1185,  0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000, -0.0000,  0.0000,  0.0000],
         [-2.4601,  0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000, -0.0000,  0.0000,  0.0000],
         [-3.6006,  0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000, -0.0000,  0.0000,  0.0000],
         [ 4.0184, -0.0000, -0.0000,  0.0000, -0.0000, -0.0000,  0.0000,  0.0000, -0.0000, -0.0000],
         [-1.4931,  0.0000,  0.0000, -0.0000,  0.0000,  0.0000, -0.0000, -0.0000,  0.0000,  0.0000]], grad_fn=&lt;MulBackward0&gt;),
 tensor([[-4.1185],
         [-2.4601],
         [-3.6006],
         [ 4.0184],
         [-1.4931]], grad_fn=&lt;IndexBackward0&gt;))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">preds</span><span class="o">*</span><span class="n">targets_as_zeros</span><span class="o">/</span><span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(31.4133, grad_fn=&lt;SumBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Trying again but even simpler.. just maximize activation of target neuron</span>
<span class="k">def</span> <span class="nf">my_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
    <span class="n">tgts</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">targets</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span> <span class="c1">#Pull out the NN output for the neuron</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#Invert them because we want to minimize loss. So the larger the absolute activation, smaller loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Need to incorporate cost of being wrong. This one tries to do so by returning the average ratio of</span>
<span class="c1">#wrong activation vs right activation. Notice that activation are not abs() in taking ratio..</span>
<span class="c1">#I think that allowing activation of wrong value to continue to be forced down into negative dimension gives more</span>
<span class="c1">#freedom for learning... Because there is more room on interval of [-inf,+inf] than [0,+inf], so more </span>
<span class="c1">#room for differentiating prediction to capitalize on</span>
<span class="k">def</span> <span class="nf">my_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
    <span class="n">tgts</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">targets</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">*</span> <span class="n">tgts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tgts</span><span class="o">.</span><span class="n">T</span><span class="p">]</span> <span class="c1">#Pull out the NN output for the neuron</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">preds</span><span class="o">/</span><span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#and found perhaps I shouldve used the cross entropy function as my loss function...</span>
<span class="c1">#=-log(softmax value of correct activation unit)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">tgts</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="c1">#Turn tensor of singleton tensors one per target into a single tensor with all as elements</span>
    <span class="k">return</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">tgts</span><span class="p">)</span> <span class="c1">#Nice</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">batch_accuracy</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="n">otpts</span> <span class="o">=</span> <span class="n">mdl</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span> <span class="c1">#Get output activations from model</span>
    <span class="n">preds</span><span class="o">=</span> <span class="n">otpts</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span> <span class="c1">#The indices of the max activation is the predicted digit of the input</span>
    <span class="n">correct</span><span class="o">=</span><span class="n">preds</span><span class="o">==</span><span class="n">yb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#Types must be tensors to return sequence of true/false</span>
    <span class="c1">#                    Use view to take it from shape=[5,1] to [5], same as preds. else will broadcast and end result all messed up</span>
    <span class="k">return</span> <span class="n">correct</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">validate_epoch</span><span class="p">(</span><span class="n">mdl</span><span class="p">):</span>
    <span class="n">outcomes</span><span class="o">=</span><span class="p">[</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">mdl</span><span class="p">,</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">valid_dl</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#This is to valdiate that we&#39;re pulling the right data, so as to validate the validate_epoch function</span>
<span class="n">validIter</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">dls</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">validIter</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
    <span class="n">show_image</span><span class="p">(</span><span class="n">xv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">yv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>9
0
6
6
9
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhklEQVR4nO3asW3CQBhA4RClZgHoqSipKRAFKzCCGYPGlTuYA0aggALECJTsQAdlpCf/Z3wBJVLeV96vC9bTSSdDOvf7/UPfPn/7Af4ag4BBwCBgEPhqmL/8Clqv17Xrl8sl3LPdbsPZbrcLZ71eL/UonbpFTwgYBAwCBgGDgEGg0/ByFw5vt1u4aTKZtH6Q2WwWzs7nczibTqfhrCiK1Ed67T7DIGAQMAgYBAwCTW+7of1+H84Oh0M4W61WrT9rs9mEs7IsW/+9FE8IGAQMAgYBg4BBIPva7Xa7WfsWi0XrPcvlMpwNBoOs54h4QsAgYBAwCBgEsm+Z0WgUzo7HYzg7nU6161VVhXtS36m+micEDAIGAYOAQcAgkP1TZq7r9Vq73u/3wz2pazx1/Tfwp8xnGAQMAgYBg4BBIPttN9dwOKxdT/3E+YOrtTVPCBgEDAIGAYOAQeAt127qn3rH43Ht+nw+f8ejtOYJAYOAQcAgYBAwCDR9yfzveELAIGAQMAgYBAwCDyCERf1DIUoqAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVR4nO3aMY4BYRiA4bHZA9DSaZxAIlE6gVJJqdRolM7BKVxA5QYKrRqlzpYbb+b7Z/yJ2GTfp5wv/5q8meSLHY3H41Ho19enb+CvMQgYBAwCBoHvinnWCrrf7+FsNBqVXj8ej+GZ9Xodzubzef0be9You+gTAgYBg4BBwCBgEGhUfLnLWruz2Syc7ff70uuLxSI8s1qtwtnlcql/Y89cu3UYBAwCBgGDgEEge+3ebrfwUKvVCmfn87n0eqfTCc8Mh8Nwttvtwlmz2QxnhWu3HoOAQcAgYBAwCFT9kzl0Op3CWWrtptZrZDAYZN1Hv99/+bN8QsAgYBAwCBgEsrdMu90OZ9PpNPfPfpxPCBgEDAIGAYOAQSB77aYcDoeXz6R+dbTdbsNZ6hVoDp8QMAgYBAwCBgGDwFt+QTQej8NZt9stvX69XnM+qthsNlnnCl9l1mMQMAgYBAwCBoG3rN3UN9fJZFJ6PfX6c7lchrNer1f/xp65duswCBgEDAIGAYNA1dr9d3xCwCBgEDAIGAQMAj/K/09KudALvAAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVR4nO3asYkCQRSA4bfHBUZiZgEGFmFgYGRmYhEWYRf2IEZWYKiIHQg2YKQdeOHBzz53ld27g/u/cB4Dw8/AsGLxeDxC3z5++wB/jUHAIGAQMAh8Vswbf4J2u13p+mq1Svdst9umjxERUZQtekPAIGAQMAgYBAwCRcXHXePP7mg0ennPfr9v+hgRPrv1GAQMAgYBg4BBoOpr9y2bzSadHQ6H0vXb7dbGUV7mDQGDgEHAIGAQMAi08uyeTqd0NpvNStd7vV66536/p7Nn+97hDQGDgEHAIGAQaOWVOR6P6ex6vZauF0XpT5wRETEYDNLZ5XKpf7AavCFgEDAIGAQMAgaBVp7d4XCYzrLfVJ89rf1+P51l/0iKiJhMJuks4w0Bg4BBwCBgEDAItPLsLhaLdHY+n0vXp9Npume5XKazbrdb/2A1eEPAIGAQMAgYBAwCP/7H3ezrdD6fp3vG43E6W6/X6azT6Tw7in/crcMgYBAwCBgEDAJVz+6/4w0Bg4BBwCBgEDAIfAFtEkDnc2WWnwAAAABJRU5ErkJggg==
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbklEQVR4nO3aMYrCQBhA4XHZwjJWNl4hp/ACdlp7BD1DupBz2KbwAt5FwUJrOy0XHvmNzm7YhX1fOT+D4TEQMji63+9JXz5++wH+GoOAQcAgYBD47JlnvYJut1s4m8/nnev7/T7cUxRFzmP0GXUtekLAIGAQMAgYBAwCfa/dLHVdh7Pz+TzET/4YTwgYBAwCBgGDgEFg1HOnGg6Px2O4aTabhbPdbte5vlwunz3HEPzafYVBwCBgEDAIGAQMAgYBg4BBwCBgEMi+Uz2dTln7VqtV5/rlcgn3rNfrcDYej7OeI+IJAYOAQcAgYBAwCAxyp1qWZThbLBad64fDIdwznU7D2Tf+eeSd6isMAgYBg4BBwCCQ/dp9ZrvdhrOmaTrXN5vN23tSSmkymYSz6/UazpKv3dcYBAwCBgGDgEFgkD/uVlX19p62bcNZ9IWcUnxpncsTAgYBg4BBwCBgEOj72v13PCFgEDAIGAQMAgaBB3+mQzXEc+gsAAAAAElFTkSuQmCC
" />
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABECAYAAAA4E5OyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVR4nO3bsW3CQBhAYYgyADUMQEXnihaG8Ab0DEIF7OAd8AQwAnQIyR0bkDLK0/02XGIlUt5X+tdF1tNJp3OS4ePxGOjT22+/wF9jEDAIGAQMAu8d86wjaL/fh7PNZpN8PpvNwjXb7TacTSaT51/sq2HqoTsEDAIGAYOAQcAgMOy43IXDuq7DRcvlMpwdDofk89Vq1fYeofP5nLVu4LH7HIOAQcAgYBAwCHTddrPM5/Nwtlgsks/X63W4Jroh98EdAgYBg4BBwCBgEMi+7d7v93BRURT5b5RwuVzC2fV6DWcdH6C97T7DIGAQMAgYBLIvd6PRKJydTqdw1jRN8nnbadH2jfZ2u4WznF9zukPAIGAQMAgYBAwCvXxTbTuSo9l0Ou3jVV7mDgGDgEHAIGAQMAj0cuzmOB6PWevG4/GPvoc7BAwCBgGDgEHAINDLsVtVVTgry/Lln7fb7cLZN/5fJskdAgYBg4BBwCBgEOj6C6J/xx0CBgGDgEHAIGAQ+ACDW0BdOJW+RAAAAABJRU5ErkJggg==
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#batch_accuracy otuput to validate its correct</span>
<span class="n">validIter</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">dls</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">validIter</span><span class="p">)</span>
<span class="n">o</span><span class="o">=</span><span class="n">myModel</span><span class="p">(</span><span class="n">xv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span><span class="n">yv</span><span class="p">,</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">myModel</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([1, 1, 6, 1, 1]) tensor([[3],
        [7],
        [0],
        [1],
        [4]]) tensor(0.1600)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">o</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[-6.1172,  7.5849,  6.6596, -0.9109,  1.7037,  3.0022, -7.0449, -3.2300,  1.6748,  5.5819],
        [-8.4815, 10.3643,  9.0917, -1.3208,  2.2753,  4.0613, -9.7575, -4.5104,  2.2356,  7.6094],
        [ 0.4390, -0.1225, -0.0845,  0.2257,  0.1185,  0.0653,  0.4770,  0.3207,  0.1197, -0.0404],
        [-5.2695,  6.5883,  5.7876, -0.7640,  1.4987,  2.6225, -6.0723, -2.7709,  1.4737,  4.8550],
        [-4.3495,  5.5068,  4.8412, -0.6045,  1.2763,  2.2103, -5.0168, -2.2726,  1.2555,  4.0660]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myModel</span><span class="p">(</span><span class="n">mini_x</span><span class="p">),</span><span class="n">mini_y</span><span class="p">,</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">myModel</span><span class="p">,</span><span class="n">mini_x</span><span class="p">,</span><span class="n">mini_y</span><span class="p">),</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">myModel</span><span class="p">)</span> <span class="c1">#validate the function works right... </span>
<span class="c1">#since train_y and _x were organized with digits in sequence (0&#39;s, then 1&#39;s, etc...), the first 5 digits</span>
<span class="c1">#being tested here are all 0&#39;s. Observe that if 1/5 outputs max value is in 0 index, then the accuracy is 0.2</span>
<span class="c1">#Might take initializing new parameters multiple times to get a correct guess, it will be random</span>
<span class="c1">#Given the relu activation, the model may yield multiple identical values for multiple guesses/vectors when relu activation</span>
<span class="c1">#was zero. In this case, the max function returns the 0 index, and 0 is the target, so 0&#39;s will be right. </span>
<span class="c1">#tbh i think this is a weakness with this model, and having a different randomly initialized bias for each feature would</span>
<span class="c1">#eliminate this and be better</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[-4.1185,  5.2352,  4.6036, -0.5644,  1.2204,  2.1069, -4.7518, -2.1475,  1.2007,  3.8679],
         [-2.4601,  3.2856,  2.8976, -0.2769,  0.8195,  1.3640, -2.8491, -1.2493,  0.8073,  2.4457],
         [-3.6006,  4.6264,  4.0708, -0.4746,  1.0952,  1.8748, -4.1576, -1.8670,  1.0779,  3.4238],
         [ 4.0184, -4.3303, -3.7665,  0.8462, -0.7469, -1.5381,  4.5836,  2.2592, -0.7293, -3.1099],
         [-1.4931,  2.1488,  1.9029, -0.1093,  0.5857,  0.9308, -1.7396, -0.7257,  0.5780,  1.6164]], grad_fn=&lt;AddBackward0&gt;),
 tensor([[0],
         [0],
         [0],
         [0],
         [0]]),
 tensor(0.),
 0.115)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testLoader</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">testLoader</span><span class="p">)</span>
<span class="n">loss</span><span class="o">=</span><span class="n">my_loss</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">xb</span><span class="p">),</span><span class="n">yb</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="o">*</span><span class="n">lr</span>
        <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(8.6665, grad_fn=&lt;NllLossBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">w1</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span><span class="o">==</span><span class="n">NoneType</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">([(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">]]))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">([(</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">]]))</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[ 0.0036,  0.0000],
        [ 0.0641,  0.0000],
        [-0.0487,  0.0000],
        [ 0.1809,  0.0000]])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Running this one and then cell below will allow to observe changes in the parameters </span>
<span class="c1">#as a result of back propagation and gradient descent!</span>
<span class="c1">#If change to parameters is not observed, run cell below to verify non zero gradient is being computed</span>
<span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span>
<span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">my_loss</span><span class="p">(</span><span class="n">myModel</span><span class="p">(</span><span class="n">xb</span><span class="p">),</span><span class="n">yb</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="o">*</span><span class="n">lr</span>
            <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span> <span class="c1">#Prints loss for each minibatch</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(7.8955, grad_fn=&lt;NllLossBackward0&gt;)
tensor(5.5976, grad_fn=&lt;NllLossBackward0&gt;)
tensor(6.0172, grad_fn=&lt;NllLossBackward0&gt;)
tensor(5.6406, grad_fn=&lt;NllLossBackward0&gt;)
tensor(5.9263, grad_fn=&lt;NllLossBackward0&gt;)
tensor(5.2161, grad_fn=&lt;NllLossBackward0&gt;)
tensor(4.9269, grad_fn=&lt;NllLossBackward0&gt;)
tensor(4.4739, grad_fn=&lt;NllLossBackward0&gt;)
tensor(4.7216, grad_fn=&lt;NllLossBackward0&gt;)
tensor(3.8051, grad_fn=&lt;NllLossBackward0&gt;)
tensor(3.8510, grad_fn=&lt;NllLossBackward0&gt;)
tensor(3.0392, grad_fn=&lt;NllLossBackward0&gt;)
tensor(3.1438, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.8495, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.6098, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.7949, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.6347, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.4974, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.3163, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2406, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1818, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.3660, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2306, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2963, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0940, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2297, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2294, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1313, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2549, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1769, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1987, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2986, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2026, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1892, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.3056, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1602, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0594, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.3139, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2606, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0796, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0918, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1626, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1314, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1663, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1291, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2918, grad_fn=&lt;NllLossBackward0&gt;)
tensor(1.9681, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0553, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2321, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0318, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0983, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.4087, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1333, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2700, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2204, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0809, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1463, grad_fn=&lt;NllLossBackward0&gt;)
tensor(1.9678, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1310, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.0630, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.1422, grad_fn=&lt;NllLossBackward0&gt;)
tensor(2.2210, grad_fn=&lt;NllLossBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#(Running this one and then the above will allow for verification/display of computation result of non zero gradients)</span>
<span class="k">def</span> <span class="nf">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span><span class="n">f_loss</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">f_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1">#Return the loss (see why later)</span>
<span class="n">calc_grad</span><span class="p">(</span><span class="n">mini_x</span><span class="p">,</span><span class="n">mini_y</span><span class="p">,</span><span class="n">myModel</span><span class="p">,</span><span class="n">my_loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2.0894858837127686</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Running this then the print cell 2 above will allow for validation of code by observing parameter change. If no change,</span>
<span class="c1">#Run one above to check gradient size</span>
<span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">f_loss</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">f_loss</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="o">*</span><span class="n">lr</span>
                <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="n">train_epoch</span><span class="p">(</span><span class="n">myModel</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,[</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">],</span><span class="n">my_loss</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">BasicOptim</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">lr</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="p">),</span><span class="n">lr</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr</span>

    <span class="k">def</span> <span class="nf">zero_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">opt</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="n">params</span><span class="p">,</span><span class="n">f_loss</span><span class="p">):</span>
    <span class="n">losses</span><span class="o">=</span><span class="p">[]</span><span class="c1">#Will allow for recording epoch wise loss</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">f_loss</span><span class="p">)</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">f_loss</span><span class="p">))</span>
        <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tensor</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span> <span class="c1">#Will allow for analyzing performance w.r.t loss as the model learns</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_opt</span><span class="o">=</span><span class="n">BasicOptim</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">],</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">res</span><span class="o">=</span><span class="n">train_epoch</span><span class="p">(</span><span class="n">myModel</span><span class="p">,</span><span class="n">my_opt</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,[</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">],</span><span class="n">my_loss</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(2.0317),
 tensor([2.0741, 1.7660, 2.2313, 1.9984, 1.8884, 2.1686, 1.7515, 2.0124, 1.9008, 2.1306, 2.1752, 1.9439, 1.9268, 1.9860, 2.1010, 2.1853, 2.2638, 2.2290, 1.9893, 1.9734, 1.9442, 2.0295, 2.1597, 2.0376,
         2.0211, 2.0450, 1.9879, 2.1127, 1.8709, 1.9576, 2.1561, 1.9560, 2.1379, 2.0640, 2.0666, 1.9608, 2.0936, 2.2478, 2.1695, 2.0455, 1.8293, 2.0236, 2.0528, 2.0663, 2.1181, 1.8855, 2.1618, 2.0844,
         1.7411, 1.9947, 1.8307, 1.8846, 1.9199, 1.9247, 1.9935, 2.1115, 2.2204, 2.1065, 2.1304, 1.9570, 1.9483, 2.2220]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">cTrial</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numE</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="n">myModel</span><span class="p">,</span><span class="n">opt</span><span class="o">=</span><span class="n">my_opt</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">w1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">b2</span><span class="p">],</span><span class="n">f_loss</span><span class="o">=</span><span class="n">my_loss</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numE</span><span class="o">=</span><span class="n">numE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="o">=</span><span class="n">lr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">=</span><span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt</span><span class="o">=</span><span class="n">opt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_loss</span><span class="o">=</span><span class="n">f_loss</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valids</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="o">=</span><span class="p">[]</span> <span class="c1"># For tracking change in weights across learning</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valids</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Reset</span>
        <span class="n">epch_losses</span><span class="o">=</span><span class="p">[]</span> <span class="c1">#Reset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="o">=</span><span class="p">[[],[],[],[]]</span> <span class="c1"># 4 contents, w1,b1,w2,b2</span>
        <span class="k">if</span> <span class="n">numE</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">numE</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">numE</span>
        <span class="k">if</span> <span class="n">wkLr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">wkLr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numE</span><span class="p">):</span>
            <span class="c1">#-- Record wts for analysis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wtsHist</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
            <span class="c1">#--</span>
            <span class="n">res</span><span class="o">=</span><span class="n">train_epoch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">opt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">f_loss</span><span class="p">)</span>
            <span class="n">epch_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">epch_losses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valids</span><span class="o">=</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valids</span><span class="p">)</span>
        <span class="c1">#self.wtsHist=[tensor([self.wtsHist[0],self.wtsHist[2]]),tensor([self.wtsHist[1],self.wtsHist[3]])]</span>
        <span class="c1">#self.res=epch_losses</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Leaving off with the below cell failing and I can&#39;t really imagine why...</span>
<span class="c1">#Also the basic &#39;activation maximizer&#39; is at risk of naively increasing ALL activations</span>
<span class="c1">#Empirically after many epochs it just chooses 1 digit for everything even as loss goes down.</span>
<span class="c1">#Need to somehow include cost of being wrong agian.. Maybe sum the average of wrong activation/tgt activation!</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Leaving off having found that commenting out the ReLu layer stops the behaviour where the gradient was zeroing out on w1,b1,w2</span>
<span class="c1">#Also implemented the &#39;average ratio of wrong activation against right one&#39; loss function</span>
<span class="c1">#Still observing that the NN is resorting to naively estimating 1 digit, resulting in constant 10% sucess rate...</span>
<span class="c1">#Was working on a function to plot the weight changes across epochs to monitor for wierd behaviour.. </span>
<span class="c1">#basically cast the list output as a tensor.. iterate through *columns* with .view()to get parameter wise data across iterations</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">=</span><span class="n">cTrial</span><span class="p">()</span>
<span class="n">my_try</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numE</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">shape</span> <span class="c1">#We see the result is a tensor of numE tensors of 62 results. We initiated the dataLoaders</span>
<span class="c1">#with 25 items to a minibatch, with 1540 data samples across all inputs, 25*62=1550, so we have 61 minibatches of 25 with</span>
<span class="c1">#one last minibatch of 15</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([50, 62])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#Return average loss across all minibatches in each epoch, in chronological sequence.</span>
<span class="c1">#If loss is going down... SUCCESS!!! (or at least its working as intended!)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([2.0169, 1.9830, 1.9666, 1.9293, 1.9145, 1.8770, 1.8447, 1.8138, 1.7978, 1.7788, 1.7664, 1.7587, 1.7477, 1.7338, 1.7375, 1.7188, 1.7214, 1.7153, 1.7065, 1.6975, 1.7047, 1.6953, 1.6931, 1.6909,
        1.6839, 1.6845, 1.6900, 1.6598, 1.6593, 1.6518, 1.6599, 1.6535, 1.6382, 1.6410, 1.6291, 1.6362, 1.6249, 1.6178, 1.6197, 1.6216, 1.6137, 1.6149, 1.6176, 1.6130, 1.6013, 1.6048, 1.6106, 1.6056,
        1.6002, 1.5979])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f8e3eb50&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">valids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f9798dd0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#What I&#39;m observing is the model always settles on choosing one of 2 possible digits,</span>
<span class="c1">#(seemingly random based on initial condition), so its performance still sucks.</span>
<span class="c1">#Wondering: What if it needs greater capacity? Greater layers?</span>
<span class="c1">#-&gt; going to redefine model..</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span> <span class="c1">#64 in, 32 out</span>
<span class="n">B1</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W2</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span> <span class="c1"># 32 in, 16 out</span>
<span class="n">B2</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># 16 in, 10 out</span>
<span class="n">B3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mdlV2</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span>
    <span class="n">res</span><span class="o">=</span> <span class="n">xb</span><span class="nd">@W1</span><span class="o">+</span><span class="n">B1</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W2</span><span class="o">+</span><span class="n">B2</span><span class="c1">#returns 10 features for each input</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W3</span><span class="o">+</span><span class="n">B3</span><span class="c1">#returns 10 features for each input</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mdlV2</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span> <span class="c1">#Test with random data sample to see the matrix multiplication works, parameters defined correctly...</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 1.0679, -1.8199,  0.4861, -0.6773, -0.4341, -0.0244, -1.4107,  0.5197,  0.7869,  0.7355],
        [ 1.2566, -2.1620,  0.7953, -0.5469, -0.4030, -0.2573, -1.2032,  0.9089,  0.6863,  0.8816],
        [ 1.6671, -2.5187,  0.7505, -0.6515, -0.0254,  0.0655, -1.9130,  0.6849,  0.3266,  0.2800],
        [ 1.3645, -2.4120,  0.5461, -0.7007, -0.4227, -0.1179, -1.6952,  0.9528,  0.6045,  1.0226],
        [ 1.7769, -2.7423,  0.7523, -0.8904, -0.1210,  0.1373, -2.2262,  0.8818,  0.4147,  0.6171]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">=</span><span class="n">cTrial</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mdlV2</span><span class="p">,</span><span class="n">opt</span><span class="o">=</span><span class="n">BasicOptim</span><span class="p">([</span><span class="n">W1</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">W2</span><span class="p">,</span><span class="n">B2</span><span class="p">,</span><span class="n">W3</span><span class="p">,</span><span class="n">B3</span><span class="p">],</span><span class="mf">0.01</span><span class="p">),</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">W1</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">W2</span><span class="p">,</span><span class="n">B2</span><span class="p">,</span><span class="n">W3</span><span class="p">,</span><span class="n">B3</span><span class="p">])</span>
<span class="n">my_try</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numE</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f3563610&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">valids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f34de510&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#to get a sense for the outputs</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">viewSamplePredictions</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">validIter</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">dls</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">validIter</span><span class="p">)</span>
    <span class="n">o</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">xv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span><span class="n">yv</span><span class="p">,</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">xv</span><span class="p">,</span><span class="n">yv</span><span class="p">))</span>
<span class="n">viewSamplePredictions</span><span class="p">(</span><span class="n">mdlV2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([4, 4, 4, 4, 4]) tensor([[2],
        [7],
        [0],
        [2],
        [1]]) tensor(0.)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">confMtx</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xv</span><span class="p">,</span><span class="n">yv</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">preds</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">xv</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xv</span><span class="p">)):</span>
            <span class="n">conf</span><span class="p">[</span><span class="n">yv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()][</span><span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span><span class="s1">&#39;6pt&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Top Axis: Predicted value. Left Axis: Actual Value&quot;</span><span class="p">)</span>
    <span class="c1">#return df</span>
<span class="n">confMtx</span><span class="p">(</span><span class="n">mdlV2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
</style>
<table id="T_e3c38_">
  <caption>Top Axis: Predicted value. Left Axis: Actual Value</caption>
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th class="col_heading level0 col0">0</th>
      <th class="col_heading level0 col1">1</th>
      <th class="col_heading level0 col2">2</th>
      <th class="col_heading level0 col3">3</th>
      <th class="col_heading level0 col4">4</th>
      <th class="col_heading level0 col5">5</th>
      <th class="col_heading level0 col6">6</th>
      <th class="col_heading level0 col7">7</th>
      <th class="col_heading level0 col8">8</th>
      <th class="col_heading level0 col9">9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e3c38_level0_row0" class="row_heading level0 row0">0</th>
      <td id="T_e3c38_row0_col0" class="data row0 col0">18</td>
      <td id="T_e3c38_row0_col1" class="data row0 col1">0</td>
      <td id="T_e3c38_row0_col2" class="data row0 col2">0</td>
      <td id="T_e3c38_row0_col3" class="data row0 col3">0</td>
      <td id="T_e3c38_row0_col4" class="data row0 col4">0</td>
      <td id="T_e3c38_row0_col5" class="data row0 col5">0</td>
      <td id="T_e3c38_row0_col6" class="data row0 col6">2</td>
      <td id="T_e3c38_row0_col7" class="data row0 col7">0</td>
      <td id="T_e3c38_row0_col8" class="data row0 col8">0</td>
      <td id="T_e3c38_row0_col9" class="data row0 col9">0</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row1" class="row_heading level0 row1">1</th>
      <td id="T_e3c38_row1_col0" class="data row1 col0">1</td>
      <td id="T_e3c38_row1_col1" class="data row1 col1">0</td>
      <td id="T_e3c38_row1_col2" class="data row1 col2">0</td>
      <td id="T_e3c38_row1_col3" class="data row1 col3">0</td>
      <td id="T_e3c38_row1_col4" class="data row1 col4">0</td>
      <td id="T_e3c38_row1_col5" class="data row1 col5">11</td>
      <td id="T_e3c38_row1_col6" class="data row1 col6">0</td>
      <td id="T_e3c38_row1_col7" class="data row1 col7">6</td>
      <td id="T_e3c38_row1_col8" class="data row1 col8">0</td>
      <td id="T_e3c38_row1_col9" class="data row1 col9">2</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row2" class="row_heading level0 row2">2</th>
      <td id="T_e3c38_row2_col0" class="data row2 col0">0</td>
      <td id="T_e3c38_row2_col1" class="data row2 col1">0</td>
      <td id="T_e3c38_row2_col2" class="data row2 col2">0</td>
      <td id="T_e3c38_row2_col3" class="data row2 col3">11</td>
      <td id="T_e3c38_row2_col4" class="data row2 col4">0</td>
      <td id="T_e3c38_row2_col5" class="data row2 col5">0</td>
      <td id="T_e3c38_row2_col6" class="data row2 col6">0</td>
      <td id="T_e3c38_row2_col7" class="data row2 col7">0</td>
      <td id="T_e3c38_row2_col8" class="data row2 col8">0</td>
      <td id="T_e3c38_row2_col9" class="data row2 col9">9</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row3" class="row_heading level0 row3">3</th>
      <td id="T_e3c38_row3_col0" class="data row3 col0">0</td>
      <td id="T_e3c38_row3_col1" class="data row3 col1">0</td>
      <td id="T_e3c38_row3_col2" class="data row3 col2">0</td>
      <td id="T_e3c38_row3_col3" class="data row3 col3">18</td>
      <td id="T_e3c38_row3_col4" class="data row3 col4">0</td>
      <td id="T_e3c38_row3_col5" class="data row3 col5">0</td>
      <td id="T_e3c38_row3_col6" class="data row3 col6">0</td>
      <td id="T_e3c38_row3_col7" class="data row3 col7">0</td>
      <td id="T_e3c38_row3_col8" class="data row3 col8">0</td>
      <td id="T_e3c38_row3_col9" class="data row3 col9">2</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row4" class="row_heading level0 row4">4</th>
      <td id="T_e3c38_row4_col0" class="data row4 col0">4</td>
      <td id="T_e3c38_row4_col1" class="data row4 col1">0</td>
      <td id="T_e3c38_row4_col2" class="data row4 col2">0</td>
      <td id="T_e3c38_row4_col3" class="data row4 col3">0</td>
      <td id="T_e3c38_row4_col4" class="data row4 col4">0</td>
      <td id="T_e3c38_row4_col5" class="data row4 col5">0</td>
      <td id="T_e3c38_row4_col6" class="data row4 col6">13</td>
      <td id="T_e3c38_row4_col7" class="data row4 col7">2</td>
      <td id="T_e3c38_row4_col8" class="data row4 col8">0</td>
      <td id="T_e3c38_row4_col9" class="data row4 col9">1</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row5" class="row_heading level0 row5">5</th>
      <td id="T_e3c38_row5_col0" class="data row5 col0">3</td>
      <td id="T_e3c38_row5_col1" class="data row5 col1">0</td>
      <td id="T_e3c38_row5_col2" class="data row5 col2">0</td>
      <td id="T_e3c38_row5_col3" class="data row5 col3">0</td>
      <td id="T_e3c38_row5_col4" class="data row5 col4">0</td>
      <td id="T_e3c38_row5_col5" class="data row5 col5">14</td>
      <td id="T_e3c38_row5_col6" class="data row5 col6">0</td>
      <td id="T_e3c38_row5_col7" class="data row5 col7">2</td>
      <td id="T_e3c38_row5_col8" class="data row5 col8">0</td>
      <td id="T_e3c38_row5_col9" class="data row5 col9">1</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row6" class="row_heading level0 row6">6</th>
      <td id="T_e3c38_row6_col0" class="data row6 col0">9</td>
      <td id="T_e3c38_row6_col1" class="data row6 col1">0</td>
      <td id="T_e3c38_row6_col2" class="data row6 col2">0</td>
      <td id="T_e3c38_row6_col3" class="data row6 col3">0</td>
      <td id="T_e3c38_row6_col4" class="data row6 col4">0</td>
      <td id="T_e3c38_row6_col5" class="data row6 col5">1</td>
      <td id="T_e3c38_row6_col6" class="data row6 col6">10</td>
      <td id="T_e3c38_row6_col7" class="data row6 col7">0</td>
      <td id="T_e3c38_row6_col8" class="data row6 col8">0</td>
      <td id="T_e3c38_row6_col9" class="data row6 col9">0</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row7" class="row_heading level0 row7">7</th>
      <td id="T_e3c38_row7_col0" class="data row7 col0">0</td>
      <td id="T_e3c38_row7_col1" class="data row7 col1">0</td>
      <td id="T_e3c38_row7_col2" class="data row7 col2">0</td>
      <td id="T_e3c38_row7_col3" class="data row7 col3">7</td>
      <td id="T_e3c38_row7_col4" class="data row7 col4">0</td>
      <td id="T_e3c38_row7_col5" class="data row7 col5">2</td>
      <td id="T_e3c38_row7_col6" class="data row7 col6">0</td>
      <td id="T_e3c38_row7_col7" class="data row7 col7">2</td>
      <td id="T_e3c38_row7_col8" class="data row7 col8">0</td>
      <td id="T_e3c38_row7_col9" class="data row7 col9">9</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row8" class="row_heading level0 row8">8</th>
      <td id="T_e3c38_row8_col0" class="data row8 col0">3</td>
      <td id="T_e3c38_row8_col1" class="data row8 col1">0</td>
      <td id="T_e3c38_row8_col2" class="data row8 col2">0</td>
      <td id="T_e3c38_row8_col3" class="data row8 col3">0</td>
      <td id="T_e3c38_row8_col4" class="data row8 col4">0</td>
      <td id="T_e3c38_row8_col5" class="data row8 col5">12</td>
      <td id="T_e3c38_row8_col6" class="data row8 col6">0</td>
      <td id="T_e3c38_row8_col7" class="data row8 col7">0</td>
      <td id="T_e3c38_row8_col8" class="data row8 col8">0</td>
      <td id="T_e3c38_row8_col9" class="data row8 col9">5</td>
    </tr>
    <tr>
      <th id="T_e3c38_level0_row9" class="row_heading level0 row9">9</th>
      <td id="T_e3c38_row9_col0" class="data row9 col0">0</td>
      <td id="T_e3c38_row9_col1" class="data row9 col1">0</td>
      <td id="T_e3c38_row9_col2" class="data row9 col2">0</td>
      <td id="T_e3c38_row9_col3" class="data row9 col3">5</td>
      <td id="T_e3c38_row9_col4" class="data row9 col4">0</td>
      <td id="T_e3c38_row9_col5" class="data row9 col5">4</td>
      <td id="T_e3c38_row9_col6" class="data row9 col6">0</td>
      <td id="T_e3c38_row9_col7" class="data row9 col7">1</td>
      <td id="T_e3c38_row9_col8" class="data row9 col8">0</td>
      <td id="T_e3c38_row9_col9" class="data row9 col9">10</td>
    </tr>
  </tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#like mothers milk. But now its output space just lacks 0,3,7! Going to add greater capacity...</span>
<span class="c1">#Funnel shaped NN</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">48</span><span class="p">))</span> <span class="c1">#64 in, 32 out</span>
<span class="n">B1v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W2v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">48</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span> <span class="c1"># 32 in, 16 out</span>
<span class="n">B2v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W3v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span> <span class="c1"># 16 in, 10 out</span>
<span class="n">B3v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W4v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">24</span><span class="p">,</span><span class="mi">18</span><span class="p">))</span> <span class="c1"># 16 in, 10 out</span>
<span class="n">B4v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">W5v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">18</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>
<span class="n">B5v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="n">W6v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B6v3</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mdlV3</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span>
    <span class="n">res</span><span class="o">=</span> <span class="n">xb</span><span class="nd">@W1v3</span><span class="o">+</span><span class="n">B1v3</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W2v3</span><span class="o">+</span><span class="n">B2v3</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W3v3</span><span class="o">+</span><span class="n">B3v3</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W4v3</span><span class="o">+</span><span class="n">B4v3</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W5v3</span><span class="o">+</span><span class="n">B5v3</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W6v3</span><span class="o">+</span><span class="n">B6v3</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mdlV3</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 345.8418,  289.0138,   60.7753,  223.0188,  113.1826,  104.4974,  336.0727, -771.3594,  334.1454,  381.0231],
        [ 210.8918,  151.5357,  136.3566,  221.9274,   72.0100,  221.6852,  366.7518, -573.8847,  342.6361,   68.7711],
        [ 509.5496,  318.0272,  156.9736,  234.6567,  102.3715,  238.3482,  468.9347, -909.8787,  501.5280,  275.4095],
        [ 318.9915,  458.8397,  -21.3896,  186.9061,   23.5667, -189.7860,   74.7113, -610.5369,  152.0016,  583.3962],
        [ 353.9034,  382.0305,  125.8823,  263.3908,   93.5603,   96.6531,  309.1708, -652.4356,  318.3333,  234.5244]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">=</span><span class="n">cTrial</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mdlV3</span><span class="p">,</span><span class="n">opt</span><span class="o">=</span><span class="n">BasicOptim</span><span class="p">([</span><span class="n">W1v3</span><span class="p">,</span><span class="n">B1v3</span><span class="p">,</span><span class="n">W2v3</span><span class="p">,</span><span class="n">B2v3</span><span class="p">,</span><span class="n">W3v3</span><span class="p">,</span><span class="n">B3v3</span><span class="p">,</span><span class="n">W4v3</span><span class="p">,</span><span class="n">B4v3</span><span class="p">,</span><span class="n">W5v3</span><span class="p">,</span><span class="n">B5v3</span><span class="p">,</span><span class="n">W6v3</span><span class="p">,</span><span class="n">B6v3</span><span class="p">],</span><span class="mf">0.01</span><span class="p">),</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">W1v3</span><span class="p">,</span><span class="n">B1v3</span><span class="p">,</span><span class="n">W2v3</span><span class="p">,</span><span class="n">B2v3</span><span class="p">,</span><span class="n">W3v3</span><span class="p">,</span><span class="n">B3v3</span><span class="p">,</span><span class="n">W4v3</span><span class="p">,</span><span class="n">B4v3</span><span class="p">,</span><span class="n">W5v3</span><span class="p">,</span><span class="n">B5v3</span><span class="p">,</span><span class="n">W6v3</span><span class="p">,</span><span class="n">B6v3</span><span class="p">])</span>
<span class="n">my_try</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numE</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span> <span class="c1">#Omit first result, makes end values not discriminable</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f9d83450&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">valids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19fa9df190&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">viewSamplePredictions</span><span class="p">(</span><span class="n">mdlV3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([0, 0, 0, 0, 0]) tensor([[8],
        [0],
        [9],
        [2],
        [1]]) tensor(0.2000)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confMtx</span><span class="p">(</span><span class="n">mdlV3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Instead of funnel shape, Ill make it wormhole shape (trumpet bell.. start wide, go narrow fast but long)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span> <span class="c1">#64 in, 32 out</span>
<span class="n">B1v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W2v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span> <span class="c1"># 32 in, 16 out</span>
<span class="n">B2v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W3v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># 16 in, 10 out</span>
<span class="n">B3v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># Feature-specific biases added</span>
<span class="n">W4v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># 16 in, 10 out</span>
<span class="n">B4v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W5v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B5v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W6v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B6v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W7v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B7v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W8v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B8v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W9v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B9v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W10v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B10v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W11v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B11v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">W12v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B12v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mdlV4</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span>
    <span class="n">res</span><span class="o">=</span> <span class="n">xb</span><span class="nd">@W1v4</span><span class="o">+</span><span class="n">B1v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W2v4</span><span class="o">+</span><span class="n">B2v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W3v4</span><span class="o">+</span><span class="n">B3v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W4v4</span><span class="o">+</span><span class="n">B4v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W5v4</span><span class="o">+</span><span class="n">B5v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W6v4</span><span class="o">+</span><span class="n">B6v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W7v4</span><span class="o">+</span><span class="n">B7v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W8v4</span><span class="o">+</span><span class="n">B8v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W9v4</span><span class="o">+</span><span class="n">B9v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W10v4</span><span class="o">+</span><span class="n">B10v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W11v4</span><span class="o">+</span><span class="n">B11v4</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="nd">@W12v4</span><span class="o">+</span><span class="n">B12v4</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mdlV4</span><span class="p">(</span><span class="n">mini_x</span><span class="p">)</span><span class="c1">#Checking math works</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 7.4950e+01,  1.7422e+02, -2.3696e+01, -3.5641e+01,  4.9170e+01,  1.5804e+02,  1.5012e+01, -1.2010e+02,  1.6857e+01, -5.1689e+01],
        [ 2.5860e+01,  5.2283e+01, -1.9358e+01, -2.6612e+01,  2.3746e+01,  3.8518e+01,  1.3859e-01, -3.9123e+01, -2.9411e+00, -4.1714e+01],
        [ 2.5161e+01,  6.0673e+01, -1.2859e+01, -2.2634e+01,  1.7738e+01,  5.2163e+01,  1.5605e+00, -4.2871e+01, -6.3931e-02, -2.9956e+01],
        [ 9.5547e+01,  2.3226e+02, -3.0140e+01, -5.3980e+01,  5.9029e+01,  2.2473e+02,  1.4448e+01, -1.5792e+02,  1.8842e+01, -7.1073e+01],
        [ 8.1295e+01,  1.9916e+02, -2.5350e+01, -4.7145e+01,  4.9380e+01,  1.9437e+02,  1.1905e+01, -1.3606e+02,  1.6377e+01, -6.0936e+01]], grad_fn=&lt;AddBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">=</span><span class="n">cTrial</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mdlV4</span><span class="p">,</span><span class="n">opt</span><span class="o">=</span><span class="n">BasicOptim</span><span class="p">([</span><span class="n">W1v4</span><span class="p">,</span><span class="n">B1v4</span><span class="p">,</span><span class="n">W2v4</span><span class="p">,</span><span class="n">B2v4</span><span class="p">,</span><span class="n">W3v4</span><span class="p">,</span><span class="n">B3v4</span><span class="p">,</span><span class="n">W4v4</span><span class="p">,</span><span class="n">B4v4</span><span class="p">,</span><span class="n">W5v4</span><span class="p">,</span><span class="n">B5v4</span><span class="p">,</span><span class="n">W6v4</span><span class="p">,</span><span class="n">B6v4</span><span class="p">,</span><span class="n">W7v4</span><span class="p">,</span><span class="n">B7v4</span><span class="p">,</span><span class="n">W8v4</span><span class="p">,</span><span class="n">B8v4</span><span class="p">,</span><span class="n">W9v4</span><span class="p">,</span><span class="n">B9v4</span><span class="p">,</span><span class="n">W10v4</span><span class="p">,</span><span class="n">B10v4</span><span class="p">,</span><span class="n">W11v4</span><span class="p">,</span><span class="n">B11v4</span><span class="p">,</span><span class="n">W12v4</span><span class="p">,</span><span class="n">B12v4</span><span class="p">],</span><span class="mf">0.01</span><span class="p">),</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">W1v4</span><span class="p">,</span><span class="n">B1v4</span><span class="p">,</span><span class="n">W2v4</span><span class="p">,</span><span class="n">B2v4</span><span class="p">,</span><span class="n">W3v4</span><span class="p">,</span><span class="n">B3v4</span><span class="p">,</span><span class="n">W4v4</span><span class="p">,</span><span class="n">B4v4</span><span class="p">,</span><span class="n">W5v4</span><span class="p">,</span><span class="n">B5v4</span><span class="p">,</span><span class="n">W6v4</span><span class="p">,</span><span class="n">B6v4</span><span class="p">,</span><span class="n">W7v4</span><span class="p">,</span><span class="n">B7v4</span><span class="p">,</span><span class="n">W8v4</span><span class="p">,</span><span class="n">B8v4</span><span class="p">,</span><span class="n">W9v4</span><span class="p">,</span><span class="n">B9v4</span><span class="p">,</span><span class="n">W10v4</span><span class="p">,</span><span class="n">B10v4</span><span class="p">,</span><span class="n">W11v4</span><span class="p">,</span><span class="n">B11v4</span><span class="p">,</span><span class="n">W12v4</span><span class="p">,</span><span class="n">B12v4</span><span class="p">])</span>
<span class="n">my_try</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numE</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#With the multiple layers of multiplication... reducing variance of initial param random sampling mitigates this..</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span> <span class="c1">#Omit first result, makes end values not discriminable</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f346e210&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_try</span><span class="o">.</span><span class="n">valids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f19f33e3990&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">viewSamplePredictions</span><span class="p">(</span><span class="n">mdlV4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([0, 0, 0, 0, 0]) tensor([[9],
        [5],
        [5],
        [6],
        [0]]) tensor(0.2000)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">confMtx</span><span class="p">(</span><span class="n">mdlV4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
</style>
<table id="T_e8460_">
  <caption>Top Axis: Predicted value. Left Axis: Actual Value</caption>
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th class="col_heading level0 col0">0</th>
      <th class="col_heading level0 col1">1</th>
      <th class="col_heading level0 col2">2</th>
      <th class="col_heading level0 col3">3</th>
      <th class="col_heading level0 col4">4</th>
      <th class="col_heading level0 col5">5</th>
      <th class="col_heading level0 col6">6</th>
      <th class="col_heading level0 col7">7</th>
      <th class="col_heading level0 col8">8</th>
      <th class="col_heading level0 col9">9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e8460_level0_row0" class="row_heading level0 row0">0</th>
      <td id="T_e8460_row0_col0" class="data row0 col0">20</td>
      <td id="T_e8460_row0_col1" class="data row0 col1">0</td>
      <td id="T_e8460_row0_col2" class="data row0 col2">0</td>
      <td id="T_e8460_row0_col3" class="data row0 col3">0</td>
      <td id="T_e8460_row0_col4" class="data row0 col4">0</td>
      <td id="T_e8460_row0_col5" class="data row0 col5">0</td>
      <td id="T_e8460_row0_col6" class="data row0 col6">0</td>
      <td id="T_e8460_row0_col7" class="data row0 col7">0</td>
      <td id="T_e8460_row0_col8" class="data row0 col8">0</td>
      <td id="T_e8460_row0_col9" class="data row0 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row1" class="row_heading level0 row1">1</th>
      <td id="T_e8460_row1_col0" class="data row1 col0">20</td>
      <td id="T_e8460_row1_col1" class="data row1 col1">0</td>
      <td id="T_e8460_row1_col2" class="data row1 col2">0</td>
      <td id="T_e8460_row1_col3" class="data row1 col3">0</td>
      <td id="T_e8460_row1_col4" class="data row1 col4">0</td>
      <td id="T_e8460_row1_col5" class="data row1 col5">0</td>
      <td id="T_e8460_row1_col6" class="data row1 col6">0</td>
      <td id="T_e8460_row1_col7" class="data row1 col7">0</td>
      <td id="T_e8460_row1_col8" class="data row1 col8">0</td>
      <td id="T_e8460_row1_col9" class="data row1 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row2" class="row_heading level0 row2">2</th>
      <td id="T_e8460_row2_col0" class="data row2 col0">20</td>
      <td id="T_e8460_row2_col1" class="data row2 col1">0</td>
      <td id="T_e8460_row2_col2" class="data row2 col2">0</td>
      <td id="T_e8460_row2_col3" class="data row2 col3">0</td>
      <td id="T_e8460_row2_col4" class="data row2 col4">0</td>
      <td id="T_e8460_row2_col5" class="data row2 col5">0</td>
      <td id="T_e8460_row2_col6" class="data row2 col6">0</td>
      <td id="T_e8460_row2_col7" class="data row2 col7">0</td>
      <td id="T_e8460_row2_col8" class="data row2 col8">0</td>
      <td id="T_e8460_row2_col9" class="data row2 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row3" class="row_heading level0 row3">3</th>
      <td id="T_e8460_row3_col0" class="data row3 col0">20</td>
      <td id="T_e8460_row3_col1" class="data row3 col1">0</td>
      <td id="T_e8460_row3_col2" class="data row3 col2">0</td>
      <td id="T_e8460_row3_col3" class="data row3 col3">0</td>
      <td id="T_e8460_row3_col4" class="data row3 col4">0</td>
      <td id="T_e8460_row3_col5" class="data row3 col5">0</td>
      <td id="T_e8460_row3_col6" class="data row3 col6">0</td>
      <td id="T_e8460_row3_col7" class="data row3 col7">0</td>
      <td id="T_e8460_row3_col8" class="data row3 col8">0</td>
      <td id="T_e8460_row3_col9" class="data row3 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row4" class="row_heading level0 row4">4</th>
      <td id="T_e8460_row4_col0" class="data row4 col0">20</td>
      <td id="T_e8460_row4_col1" class="data row4 col1">0</td>
      <td id="T_e8460_row4_col2" class="data row4 col2">0</td>
      <td id="T_e8460_row4_col3" class="data row4 col3">0</td>
      <td id="T_e8460_row4_col4" class="data row4 col4">0</td>
      <td id="T_e8460_row4_col5" class="data row4 col5">0</td>
      <td id="T_e8460_row4_col6" class="data row4 col6">0</td>
      <td id="T_e8460_row4_col7" class="data row4 col7">0</td>
      <td id="T_e8460_row4_col8" class="data row4 col8">0</td>
      <td id="T_e8460_row4_col9" class="data row4 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row5" class="row_heading level0 row5">5</th>
      <td id="T_e8460_row5_col0" class="data row5 col0">20</td>
      <td id="T_e8460_row5_col1" class="data row5 col1">0</td>
      <td id="T_e8460_row5_col2" class="data row5 col2">0</td>
      <td id="T_e8460_row5_col3" class="data row5 col3">0</td>
      <td id="T_e8460_row5_col4" class="data row5 col4">0</td>
      <td id="T_e8460_row5_col5" class="data row5 col5">0</td>
      <td id="T_e8460_row5_col6" class="data row5 col6">0</td>
      <td id="T_e8460_row5_col7" class="data row5 col7">0</td>
      <td id="T_e8460_row5_col8" class="data row5 col8">0</td>
      <td id="T_e8460_row5_col9" class="data row5 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row6" class="row_heading level0 row6">6</th>
      <td id="T_e8460_row6_col0" class="data row6 col0">20</td>
      <td id="T_e8460_row6_col1" class="data row6 col1">0</td>
      <td id="T_e8460_row6_col2" class="data row6 col2">0</td>
      <td id="T_e8460_row6_col3" class="data row6 col3">0</td>
      <td id="T_e8460_row6_col4" class="data row6 col4">0</td>
      <td id="T_e8460_row6_col5" class="data row6 col5">0</td>
      <td id="T_e8460_row6_col6" class="data row6 col6">0</td>
      <td id="T_e8460_row6_col7" class="data row6 col7">0</td>
      <td id="T_e8460_row6_col8" class="data row6 col8">0</td>
      <td id="T_e8460_row6_col9" class="data row6 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row7" class="row_heading level0 row7">7</th>
      <td id="T_e8460_row7_col0" class="data row7 col0">20</td>
      <td id="T_e8460_row7_col1" class="data row7 col1">0</td>
      <td id="T_e8460_row7_col2" class="data row7 col2">0</td>
      <td id="T_e8460_row7_col3" class="data row7 col3">0</td>
      <td id="T_e8460_row7_col4" class="data row7 col4">0</td>
      <td id="T_e8460_row7_col5" class="data row7 col5">0</td>
      <td id="T_e8460_row7_col6" class="data row7 col6">0</td>
      <td id="T_e8460_row7_col7" class="data row7 col7">0</td>
      <td id="T_e8460_row7_col8" class="data row7 col8">0</td>
      <td id="T_e8460_row7_col9" class="data row7 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row8" class="row_heading level0 row8">8</th>
      <td id="T_e8460_row8_col0" class="data row8 col0">20</td>
      <td id="T_e8460_row8_col1" class="data row8 col1">0</td>
      <td id="T_e8460_row8_col2" class="data row8 col2">0</td>
      <td id="T_e8460_row8_col3" class="data row8 col3">0</td>
      <td id="T_e8460_row8_col4" class="data row8 col4">0</td>
      <td id="T_e8460_row8_col5" class="data row8 col5">0</td>
      <td id="T_e8460_row8_col6" class="data row8 col6">0</td>
      <td id="T_e8460_row8_col7" class="data row8 col7">0</td>
      <td id="T_e8460_row8_col8" class="data row8 col8">0</td>
      <td id="T_e8460_row8_col9" class="data row8 col9">0</td>
    </tr>
    <tr>
      <th id="T_e8460_level0_row9" class="row_heading level0 row9">9</th>
      <td id="T_e8460_row9_col0" class="data row9 col0">20</td>
      <td id="T_e8460_row9_col1" class="data row9 col1">0</td>
      <td id="T_e8460_row9_col2" class="data row9 col2">0</td>
      <td id="T_e8460_row9_col3" class="data row9 col3">0</td>
      <td id="T_e8460_row9_col4" class="data row9 col4">0</td>
      <td id="T_e8460_row9_col5" class="data row9 col5">0</td>
      <td id="T_e8460_row9_col6" class="data row9 col6">0</td>
      <td id="T_e8460_row9_col7" class="data row9 col7">0</td>
      <td id="T_e8460_row9_col8" class="data row9 col8">0</td>
      <td id="T_e8460_row9_col9" class="data row9 col9">0</td>
    </tr>
  </tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Finding that training across just a few epochs, the model is learning to take a stab at all numbers!</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#bad random starting place, then reduce over time to hone in on a local optimum... Can try this?...</span>
<span class="c1">#Defining new function (alternatively could be made a method of Learner):</span>
<span class="k">def</span> <span class="nf">shrinkSteps</span><span class="p">(</span><span class="n">lrnr</span><span class="p">,</span><span class="n">numE</span><span class="p">,</span><span class="n">lrHi</span><span class="p">,</span><span class="n">lrLo</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">lr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lrHi</span><span class="p">,</span><span class="n">lrLo</span><span class="p">,</span><span class="n">numE</span><span class="p">):</span>
        <span class="n">lrnr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">numE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">wkLr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_try</span><span class="o">=</span><span class="n">cTrial</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">mdlV4</span><span class="p">,</span><span class="n">opt</span><span class="o">=</span><span class="n">BasicOptim</span><span class="p">([</span><span class="n">W1v4</span><span class="p">,</span><span class="n">B1v4</span><span class="p">,</span><span class="n">W2v4</span><span class="p">,</span><span class="n">B2v4</span><span class="p">,</span><span class="n">W3v4</span><span class="p">,</span><span class="n">B3v4</span><span class="p">,</span><span class="n">W4v4</span><span class="p">,</span><span class="n">B4v4</span><span class="p">,</span><span class="n">W5v4</span><span class="p">,</span><span class="n">B5v4</span><span class="p">,</span><span class="n">W6v4</span><span class="p">,</span><span class="n">B6v4</span><span class="p">,</span><span class="n">W7v4</span><span class="p">,</span><span class="n">B7v4</span><span class="p">,</span><span class="n">W8v4</span><span class="p">,</span><span class="n">B8v4</span><span class="p">,</span><span class="n">W9v4</span><span class="p">,</span><span class="n">B9v4</span><span class="p">,</span><span class="n">W10v4</span><span class="p">,</span><span class="n">B10v4</span><span class="p">,</span><span class="n">W11v4</span><span class="p">,</span><span class="n">B11v4</span><span class="p">,</span><span class="n">W12v4</span><span class="p">,</span><span class="n">B12v4</span><span class="p">],</span><span class="mf">0.01</span><span class="p">),</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">W1v4</span><span class="p">,</span><span class="n">B1v4</span><span class="p">,</span><span class="n">W2v4</span><span class="p">,</span><span class="n">B2v4</span><span class="p">,</span><span class="n">W3v4</span><span class="p">,</span><span class="n">B3v4</span><span class="p">,</span><span class="n">W4v4</span><span class="p">,</span><span class="n">B4v4</span><span class="p">,</span><span class="n">W5v4</span><span class="p">,</span><span class="n">B5v4</span><span class="p">,</span><span class="n">W6v4</span><span class="p">,</span><span class="n">B6v4</span><span class="p">,</span><span class="n">W7v4</span><span class="p">,</span><span class="n">B7v4</span><span class="p">,</span><span class="n">W8v4</span><span class="p">,</span><span class="n">B8v4</span><span class="p">,</span><span class="n">W9v4</span><span class="p">,</span><span class="n">B9v4</span><span class="p">,</span><span class="n">W10v4</span><span class="p">,</span><span class="n">B10v4</span><span class="p">,</span><span class="n">W11v4</span><span class="p">,</span><span class="n">B11v4</span><span class="p">,</span><span class="n">W12v4</span><span class="p">,</span><span class="n">B12v4</span><span class="p">])</span>
<span class="n">shrinkSteps</span><span class="p">(</span><span class="n">my_try</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">01</span><span class="p">)</span>
<span class="c1">#Unfortunately still naive at a broad range of values</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Now trying a needle format NN </span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#64 in, 10 out</span>
<span class="n">B1v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W2v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 
<span class="n">B2v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">W3v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 
<span class="n">B3v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">W4v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 
<span class="n">B4v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W5v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B5v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W6v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B6v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W7v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B7v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W8v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B8v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W9v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B9v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W10v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B10v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W11v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B11v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">W12v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">B12v4</span><span class="o">=</span><span class="n">init_params</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#(Also fixed an error in how batch accuracy was computed...)</span>
<span class="c1">#It turns out the size of parameters when initialized also has a huge impact on outcomes</span>
<span class="c1">#Depending on shape of NN, large params can lead to naive selection of only a single digit that then never learns</span>
<span class="c1">#I had reduced standard dev of initialization distribution when experimenting with later models, but this proved</span>
<span class="c1">#just the trick for mdlV2! Achieved 93% digit recognition on the validation set! :)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/Posts/2022/08/02/Building-A-Digit-Classifier.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/Posts/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/Posts/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/Posts/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Where I share my projects and thoughts.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/DavidD003" target="_blank" title="DavidD003"><svg class="svg-icon grey"><use xlink:href="/Posts/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.youtube.com/channel%2FUCr8HDUNoTaT2QIfLktXk3Jg" target="_blank" title="channel/UCr8HDUNoTaT2QIfLktXk3Jg"><svg class="svg-icon grey"><use xlink:href="/Posts/assets/minima-social-icons.svg#youtube"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
